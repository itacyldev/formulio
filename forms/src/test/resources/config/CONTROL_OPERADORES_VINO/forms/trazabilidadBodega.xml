<main id="trazabilidadBodega" name="Trazabilidad barrica" repo="trazabilidadRepo" mainForm="false">
    <list id="listTrazabilidadBodega" name="Trazabilidad bodega" description="Listado trazabilidad bodega">
        <datatable/>
           <buttonbar type="fab"/>
    </list>
    <edit id="editTrazabilidadBodega">
        <script src="scripts/control.js"/>
        <form id="formTrazabilidadBodega">

            <p value=""/>
            <p backgroundColor="#26a69a" fontSize="22" fontColor="#FFFFFF" bold="true" value="ENVEJECIMIENTO BODEGA"/>
            <p value=""/>

            <table headerText=" Id. Exp., Nº Exp., Id. DOP, DOP" weights="25, 15, 15, 45">
                <row>
                    <input id="expediente_id" value="${entity.trazabilidad.expediente_id}" placeHolder="${params.expediente_id}" readonly="true"/>
                    <input id="num_expediente" value="${entity.trazabilidad.expediente.num_expediente}" placeHolder="${params.num_expediente}" readonly="true"/>
                    <input id="dop_id" value="${entity.trazabilidad.expediente.dop_id}" placeHolder="${params.dop_id}" readonly="true"/>
                    <input id="dop" value="${entity.trazabilidad.expediente.dop.dop}" placeHolder="${params.dop}" readonly="true"/>
                </row>
            </table>
            <table headerText=" Id. Partida, Partida" weights="15, 85">
                <row>
                    <input id="trazabilidad_id" value="${entity.trazabilidad_id}" placeHolder="${params.trazabilidad_id}" readonly="true"/>
                    <input id="partida" value="${entity.trazabilidad.trazabilidad.partida}" placeHolder="${params.partida}" readonly="true"/>

                </row>
            </table>
            <table headerText=" Id. Tipo, Tipo Envejecimiento" weights="15, 85">
                <row>
                    <input id="tipo_envejecimiento_id" value="${params.tipo_envejecimiento_id}" readonly="true"/>
                    <input onBeforeRender="updateTipoEnvejecimiento" readonly="true"/>
                </row>
            </table>
            <table headerText=" Id. Operador, Razón social" weights="15, 85">
                <row>
                    <input id="operador_id" value="${entity.trazabilidad.expediente.operador_id}" placeHolder="${params.operador_id}" readonly="true"/>
                    <input id="razon_social" value="${entity.trazabilidad.expediente.operador.razon_social}" placeHolder="${params.razon_social}" readonly="true"/>
                </row>
            </table>

            <divisor color="#00766C" strokeWidth="8" />
            <p bold="true" value="Envejecimiento bodega"/>
            <divisor color="#00766C" strokeWidth="8" />

            <table>
                <row>
                    <date id="fecha_inicio_envejecimiento" label="${not empty(view.tipo_envejecimiento_id) and math:round(view.tipo_envejecimiento_id) le 2?'F. inicio envejecimiento: ':'F. llenado de botella: '}" readonly="${empty(view.tipo_envejecimiento_id)}" value="${entity.fecha_inicio_envejecimiento}" hint="${math:round(view.tipo_envejecimiento_id) le 2?'Se puede considerar la fecha de fin de fermentación alcohólica o en su caso, lo que indique el Pliego, por ejemplo 1 de noviembre':null}" hasTodayButton="false" validator="required"/>
                    <date id="fecha_calificacion_bodega" label="${not empty(view.tipo_envejecimiento_id) and math:round(view.tipo_envejecimiento_id) le 2?'F. calificación: ':'F. calificación: '}" readonly="${empty(view.tipo_envejecimiento_id)}" value="${entity.fecha_calificacion_bodega}" hasTodayButton="false" validator="required"/>
                </row>

                  <row weights="30, 40, 30">
                    <input id="tiempo_bodega" label="${not empty(view.tipo_envejecimiento_id) and math:round(view.tipo_envejecimiento_id) le 2?'Meses en bodega: ':'Meses en botella: '}" value="${view.fecha_inicio_envejecimiento+''+view.fecha_calificacion_bodega}" onBeforeRender="updateTiempoBodega" readonly="true"/>
                    <input id="meses_bodega" label="${not empty(view.tipo_envejecimiento_id) and math:round(view.tipo_envejecimiento_id) le 2?'Periodo mínimo envejecimento bodega: ':'Periodo mínimo envejecimento botella: '}" value="${view.tipo_envejecimiento_id}" onBeforeRender="updateMesesBodega" readonly="true" render="${view.tipo_envejecimiento_id le 6}"/>
                    <radio id="cumple_envejecimiento_bodega" label="${not empty(view.tipo_envejecimiento_id) and math:round(view.tipo_envejecimiento_id) le 2?'Cumple envejecimiento bodega: ':'Cumple envejecimiento botella: '}" value="${view.fecha_inicio_envejecimiento+''+view.fecha_calificacion_bodega+''+view.tipo_envejecimiento_id}" orientation="horizontal" onBeforeRender="updateCumpleEnvejecimientoBodega" readonly="true" render="${view.tipo_envejecimiento_id le 6}">
                        <options>
                            <option label="SI" value="SI"/>
                            <option label="NO" value="NO"/>
                        </options>
                    </radio>
                </row>
            </table>
        </form>
        <buttonbar type="bottom">
            <button label="Save">
               <action id="compositeSaveAction">
                    <action type="save">
                    </action>
                    <action type="js" route="back" registerInHistory="false" restoreView="true">
                        <param name="method" value="setMesesBodega" />
                        <param name="entityId" value="${params.trazabilidad_id}" />
                    </action>
                </action>
            </button>
            <button label="Cancel">
                <action type="cancel" route="back" restoreView="true">
                    <param name="entityId" value="${params.trazabilidad_id}" />
                </action>
            </button>

        </buttonbar>
    </edit>
</main>
