<main id="idRecinto" name="Recinto" repo="recintoRepo">
    <list id="listRecinto" name="RECINTOS" description="Listado de recintos">
        <datatable>
            <column id="column_c_recinto_id" headerText="Id. Recinto" filtering="true" ordering="true" value="${entity.c_recinto_id}">
                <filter property="c_recinto_id" matching="contains" valueExpression="${this.column_c_recinto_id}"/>
                <order property="c_recinto_id"/>
            </column>
            <column id="column_c_refrec" headerText="Referencia" filtering="true" ordering="true" value="${entity.c_refrec}">
                <filter property="c_refrec" matching="contains" valueExpression="${this.column_c_refrec}"/>
                <order property="c_refrec"/>
            </column>
            <column id="provincia" headerText="Provincia" filtering="false" ordering="false" value="${entity.provincia.d_provincia}"/>
            <column id="municipio" headerText="Municipio" filtering="false" ordering="false" value="${entity.municipio.d_nombre}"/>
        </datatable>
    </list>
    <edit id="editRecinto">
        <script src="scripts/control.js"/>
        <form id="formRecinto">

            <p value=""/>
            <p backgroundColor="#26a69a" fontSize="22" fontColor="#FFFFFF" bold="true" value="RECINTO"/>
            <p value=""/>

            <table>
                <row>
                    <p backgroundColor="#26a69a" fontSize="18" fontColor="#FFFFFF" bold="true" value=" Provincia"/>
                </row>
                <row>
                    <input id="cod_provincia" label="Código provincia: " readonly="true"/>
                    <autocomplete forceSelection="true" id="c_provincia_id" label="Provincia: " repo="provinciaRepo" value="${entity.c_provincia_id}" validator="required">
                        <options labelExpression="${entity.d_provincia}" labelFilteringProperty="d_provincia" valueProperty="c_provincia_id" />
                        <action type="js">
                            <param name="method" value="updateCodigoProvincia" />
                        </action>
                    </autocomplete>
                </row>
            </table>
            <table>
                <row>
                    <p backgroundColor="#26a69a" fontSize="18" fontColor="#FFFFFF" bold="true" value=" Municipio"/>
                </row>
                <row>
                    <input id="cod_municipio" label="Código Municipio: " readonly="true"/>
                    <autocomplete forceSelection="true" id="c_provmuni_id" label="Municipio: " repo="municipioRepo" value="${entity.c_provmuni_id}" validator="required">
                        <options labelExpression="${entity.d_nombre}" labelFilteringProperty="d_nombre" valueProperty="c_provmuni_id" />
                        <repofilter>
                            <eq property="c_provincia_id" value="${view.c_provincia_id}" mandatory="true"/>
                            <contains property="d_nombre" value="${this.value}"/>
                        </repofilter>
                        <action type="js">
                            <param name="method" value="updateCodigoMunicipio" />
                        </action>
                    </autocomplete>
                </row>
            </table>
            <table>
                <row>
                    <p backgroundColor="#26a69a" fontSize="18" fontColor="#FFFFFF" bold="true" value=" Recinto"/>
                </row>
                <row>
                    <input id="c_agregado" label="Agregado: " value="${entity.c_agregado}" inputType="3" validator="required">
                    </input>
                    <input id="c_zona" label="Zona: " value="${entity.c_zona}" inputType="3" validator="required">
                    </input>
                    <input id="c_poligono" label="Polígono: " value="${entity.c_poligono}" inputType="3" validator="required">
                    </input>
                    <input id="c_parcela" label="Parcela: " value="${entity.c_parcela}" inputType="3" validator="required">
                    </input>
                    <input id="c_recinto" label="Recinto: " value="${entity.c_recinto}" inputType="3" validator="required">
                    </input>
                </row>
            </table>
            <button label="GENERAR REFERENCIA"  readonly="${empty (view.c_provincia_id) or empty(view.c_provmuni_id) or empty(view.c_agregado) or empty(view.c_zona) or empty(view.c_poligono) or empty(view.c_parcela) or empty(view.c_recinto)}" readonlyMessage="Debe rellenar todos los datos para poder generar la referencia">
                <action type="js">
                    <param name="method" value="updateReferencia" />
                </action>
            </button>
            <table>
                <row>
                    <p backgroundColor="#26a69a" fontSize="18" fontColor="#FFFFFF" bold="true" value=" Referencia"/>
                </row>
                <row>
                    <input id="c_refrec" label="Referencia: " value="${entity.c_refrec}" inputType="3" validator="required"/>
                </row>
            </table>
            <button label="DESGLOSAR REFERENCIA"  readonly="${empty (view.c_refrec)}" readonlyMessage="Debe rellenar el campo referencia referencia">
                <action type="js">
                    <param name="method" value="updateCamposRecinto" />
                </action>
            </button>

        </form>

        <buttonbar type="bottom">
            <button label="Save">
                <action type="save" route="back" registerInHistory="false" restoreView="true">
                    <param name="entityId" value="${params.visita_id}" />
                </action>
            </button>

            <button label="Cancel">
                <action type="cancel" route="back" restoreView="true">
                    <param name="entityId" value="${params.visita_id}" />
                </action>
            </button>

            <button label="Delete" readonly="${empty (entity.c_recinto_id)}" readonlyMessage="No puede realizar esta acción: No existe el recinto" restoreView="true">
                <action type="delete" route="back" registerInHistory="false">
                    <param name="entityId" value="${params.visita_id}" />
                </action>
            </button>
        </buttonbar>
    </edit>
</main>
