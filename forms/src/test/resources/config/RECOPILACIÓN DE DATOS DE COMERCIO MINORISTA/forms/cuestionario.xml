<main name="Cuestionario" description="Cuestionario" id="idCuestionario" repo="inspeccionRepo" mainForm="false">
    <list id="listCuestionario" name="Cuestionario">
        <datatable  route="idCuestionario-Cuestionario"/>
        <buttonbar type="fab"/>
    </list>
    <edit id="editCuestionario">
        <script src="scripts/control.js"/>
        <p value=""/>
        <divisor color="#00766C" strokeWidth="8" />
        <p bold="true" value="Cuestionario de la inspecciÃ³n ${params.c_inspeccion}"/>
        <divisor color="#00766C" strokeWidth="8" />

        <table border="false">
            <row colspan="50, 25, 25">
                <p value=""/>
                <button label="Todos SI" render="${params.b_firmado != 1 and params.b_cancelada == 0}">
                    <action type="js" controller="datalistControlCuestionario">
                        <param name="method" value="todosSi" />
                    </action>
                </button>
                <button label="Todos NO" render="${params.b_firmado != 1 and params.b_cancelada == 0}">
                    <action type="js" controller="datalistControlCuestionario">
                        <param name="method" value="todosNo" />
                    </action>
                </button>
                <button label="Todos N/A" render="${params.b_firmado != 1 and params.b_cancelada == 0}">
                    <action type="js" controller="datalistControlCuestionario">
                        <param name="method" value="todosNA" />
                    </action>
                </button>
            </row>
        </table>

        <datalist id="datalistControlCuestionario" repo="respuestaRespondidaRepo">
            <repofilter>
                <and>
                    <eq property="c_cuestionario_respondido" value="${params.c_cuestionario_respondido}" />
                </and>
            </repofilter>
            <datalistitem>
                <table>
                    <row>
                        <radio id="respuestaLabel" orientation="horizontal" label="${entity.respuesta.pregunta.d_pregunta}" validator="required"
                            value="${entity.d_respuesta}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}">
                            <options>
                                <option label="SI" value="1" />
                                <option label="NO" value="0" />
                                <option label="N/A" value="2" />
                            </options>
                        </radio>
                    </row>
                    <row>
                        <textarea id="observaciones_cuestionario" label="Observaciones: " value="${entity.d_observaciones}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}"/>
                    </row>
                </table>
                <p value="" />
            </datalistitem>
        </datalist>

        <buttonbar type="bottom">
            <button label="Save">
                <action id="compositeAction">
                    <action type="save" controller="datalistControlCuestionario">
                        <param name="entityId" value="${params.c_accion_singra_id}" />
                    </action>
                    <action type="js">
                        <param name="method" value="setInspeccionadoCuestionario" />
                        <param name="c_accion_singra_id" value="${params.c_accion_singra_id}" />
                    </action>
                    <action type="js">
                        <param name="method" value="setDFicheroPrevia" />
                        <param name="c_accion_singra_id" value="${params.c_accion_singra_id}" />
                    </action>
                    <action type="js" route="back" registerInHistory="false" restoreView="true">
                        <param name="method" value="setFirmaEntidad" />
                        <param name="c_accion_singra_id" value="${params.c_accion_singra_id}" />
                        <param name="firma_entidad" value="${params.firma_entidad}" />
                    </action>
                </action>
            </button>
            <button label="Cancel">
                <action type="cancel" route="back" restoreView="true">
                    <param name="entityId" value="${params.c_accion_singra_id}" />
                </action>
            </button>
        </buttonbar>
    </edit>
</main>
