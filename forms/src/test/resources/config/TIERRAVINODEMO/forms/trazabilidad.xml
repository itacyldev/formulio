<main id="trazabilidad" name="Trazabilidad" repo="trazabilidadRepo" mainForm="false">
    <list id="listTrazabilidad" name="Trazabilidad" description="Listado trazabilidad">
       <datatable>
           <column id="column_partida" headerText="Partida" filtering="true" ordering="true" value="${entity.partida}">
               <filter property="partida" matching="contains" valueExpression="${this.column_partida}"/>
               <order property="partida"/>
           </column>
           <column id="column_num_expediente" headerText="Expediente" filtering="false" ordering="false" value="${entity.expediente.num_expediente}"/>
       </datatable>
        <buttonbar type="fab"/>
    </list>
    <edit id="editTrazabilidad">
        <form id="formTrazabilidad">

            <p value=""/>
            <p backgroundColor="#26a69a" fontSize="22" fontColor="#FFFFFF" bold="true" value="TRAZABILIDAD"/>

            <table headerText=" Id. Exp., Nº Exp., Id. DOP, DOP" weights="20, 30, 10, 40">
                <row>
                    <input id="expediente_id" value="${entity.expediente_id}" placeHolder="${params.expediente_id}" readonly="true"/>
                    <input id="num_expediente" value="${entity.expediente.num_expediente}" placeHolder="${params.num_expediente}" readonly="true"/>
                    <input id="dop_id" value="${entity.expediente.dop_id}" placeHolder="${params.dop_id}" readonly="true"/>
                    <input id="dop" value="${entity.expediente.dop.dop}" placeHolder="${params.dop}" readonly="true"/>
                </row>
            </table>
            <table headerText=" Id. Operador, Razón social" weights="20, 80">
                <row>
                    <input id="operador_id" value="${entity.expediente.operador_id}" placeHolder="${params.operador_id}" readonly="true"/>
                    <input id="razon_social" value="${entity.expediente.operador.razon_social}" placeHolder="${params.razon_social}" readonly="true"/>
                </row>
            </table>


            <p value=""/>

            <tab>
                <tabitem label="TRAZABILIDAD">

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Partida"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row weights="15,35, 50">
                            <input id="trazabilidad_id" label="Id.: " value="${entity.trazabilidad_id}" readonly="true"/>
                            <input id="partida" label="Partida: " value="${entity.partida}" validator="required"/>
                            <input label="Nº de contraetiqueta: " value="${entity.num_contraetiqueta}" inputType="3"/>
                        </row>
                        <row>
                            <input label="Tipo de vino calificado: " value="${entity.tipo_vino}"/>
                            <input label="Volumen de la partida: " value="${entity.volumen}" inputType="3"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Fecha calificación"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <date label="Fecha calificación:" value="${entity.fecha_fisico_quimico}"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Aptitud fisico-quimica"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <radio label="Apto: " value="${entity.apto_fisico_quimico}" orientation="horizontal">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                            <table border="false">
                                <row weights="25, 75">
                                    <table border="false">
                                        <row>
                                            <switcher id="switcherImagenFisicoQuimico" value="${not empty(entity.imagen_fisico_quimico)?1:0}"/>
                                        </row>
                                    </table>
                                    <table border="false">
                                        <row>
                                            <image converter="b64Image" embedded="true" value="${entity.imagen_fisico_quimico}" render="${view.switcherImagenFisicoQuimico eq 'true'}" hasDeleteButton="false" inputType="5"/>
                                        </row>
                                    </table>
                                </row>
                            </table>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Aptitud organoléptica"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <radio label="Apto: " value="${entity.apto_organileptico}" orientation="horizontal">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                            <table border="false">
                                <row weights="25, 75">
                                    <table border="false">
                                        <row>
                                            <switcher id="switcherImagenOrganoleptico" value="${not empty(entity.imagen_organileptico)?1:0}"/>
                                        </row>
                                    </table>
                                    <table border="false">
                                        <row>
                                            <image converter="b64Image" embedded="true" value="${entity.imagen_organileptico}" render="${view.switcherImagenOrganoleptico eq 'true'}" hasDeleteButton="false" inputType="5"/>
                                        </row>
                                    </table>
                                </row>
                            </table>
                        </row>
                    </table>


                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Calificación (Pliego de condiciones)"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <radio id="cumple_calificacion" label="Cumple: " value="${entity.cumple_calificacion}" orientation="horizontal">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                            <textarea id="observaciones_calificacion" label="Observaciones" value="${entity.observaciones_calificacion}"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Numeración de contraetiquetas asignadas"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value=""/>

                    <!--<table headerText=" Desde, Hasta, Nº de contras asignadas a la partida">
                        <row>
                            <input id="desde_contras_usadas" label="Desde: " value="${entity.desde_contras_usadas}" inputType="3"/>
                            <input id="hasta_contras_usadas" label="Hasta: " value="${entity.hasta_contras_usadas}" inputType="3"/>
                            <input id="contras_usadas" value="${(view.desde_contras_usadas gt 0 and view.hasta_contras_usadas gt 0)?view.hasta_contras_usadas - view.desde_contras_usadas + 1:null}" inputType="3" readonly="true"/>
                        </row>
                    </table>-->

                    <button label="Añadir" readonly="${empty (entity.trazabilidad_id)}">
                        <action type="save" route="numeracionContraetiquetado-editNumeracionContraetiquetado">
                            <param name="expediente_id" value="${view.expediente_id}" />
                            <param name="num_expediente" value="${view.num_expediente}" />
                            <param name="operador_id" value="${view.operador_id}"/>
                            <param name="razon_social" value="${view.razon_social}"/>
                            <param name="dop_id" value="${view.dop_id}"/>
                            <param name="dop" value="${view.dop}"/>
                            <param name="trazabilidad_id" value="${view.trazabilidad_id}"/>
                            <param name="partida" value="${view.partida}"/>
                            <param name="asignada" value="Y"/>
                        </action>
                    </button>

                    <datatable onBeforeRender="setContraetiquetasNumeracionesUtilizadas"
                        route="numeracionContraetiquetado-editNumeracionContraetiquetado"
                        numVisibleRows="3"
                        repo="numeracionContraetiquetadoRepo"
                        allowsPartialRestore="false">
                        <column headerText="Etiquetado desde" filtering="false" ordering="true" value="${entity.etiqueta_desde}">
                            <order property="etiqueta_desde"/>
                        </column>
                        <column headerText="Desde" filtering="false" ordering="true" value="${entity.desde}">
                            <order property="desde"/>
                        </column>
                        <column headerText="Etiquetado hasta" filtering="false" ordering="true" value="${entity.etiqueta_hasta}">
                            <order property="etiqueta_hasta"/>
                        </column>
                        <column headerText="Hasta" filtering="false" ordering="true" value="${entity.hasta}">
                            <order property="hasta"/>
                        </column>
                        <column headerText="Unidades" filtering="false" ordering="true" value="${entity.unidades}">
                            <order property="hasta"/>
                        </column>
                        <param name="expediente_id" value="${view.expediente_id}" />
                        <param name="num_expediente" value="${view.num_expediente}" />
                        <param name="operador_id" value="${view.operador_id}"/>
                        <param name="razon_social" value="${view.razon_social}"/>
                        <param name="dop_id" value="${view.dop_id}"/>
                        <param name="dop" value="${view.dop}"/>
                        <param name="trazabilidad_id" value="${view.trazabilidad_id}"/>
                        <param name="partida" value="${view.partida}"/>
                        <param name="asignada" value="Y"/>
                        <repofilter>
                            <and>
                                <eq property="trazabilidad_id" value="${empty(entity.trazabilidad_id) ? '-1' : entity.trazabilidad_id}" />
                                <eq property="asignada" value="Y" />
                            </and>
                        </repofilter>
                    </datatable>
                    <table border="false" weights="30, 70">
                        <row>
                            <p bold="true" allowsPartialRestore="false" value="Nº de contras asignadas a la partida: " readonly="true"/>
                            <input id="contras_usadas" allowsPartialRestore="false" value="${entity.contras_usadas}" readonly="true"/>
                        </row>
                    </table>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Existencia en bodega de contras sin utilizar"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value=""/>

                    <!--<table headerText=" Desde, Hasta, Nº de contras sin utilizar">
                        <row>
                            <input id="desde_contras_sin_usar" label="Desde: " value="${entity.desde_contras_sin_usar}" inputType="3"/>
                            <input id="hasta_contras_sin_usar" label="Hasta: " value="${entity.hasta_contras_sin_usar}" inputType="3"/>
                            <input id="contras_sin_usar" value="${(view.hasta_contras_sin_usar gt 0 and view.desde_contras_sin_usar gt 0)?view.hasta_contras_sin_usar - view.desde_contras_sin_usar + 1:null}" inputType="3" readonly="true"/>
                        </row>
                    </table>-->
                    <button label="Añadir" readonly="${empty (entity.trazabilidad_id)}">
                        <action type="save" route="numeracionContraetiquetado-editNumeracionContraetiquetado">
                            <param name="expediente_id" value="${view.expediente_id}" />
                            <param name="num_expediente" value="${view.num_expediente}" />
                            <param name="operador_id" value="${view.operador_id}"/>
                            <param name="razon_social" value="${view.razon_social}"/>
                            <param name="dop_id" value="${view.dop_id}"/>
                            <param name="dop" value="${view.dop}"/>
                            <param name="trazabilidad_id" value="${view.trazabilidad_id}"/>
                            <param name="partida" value="${view.partida}"/>
                            <param name="asignada" value="N"/>
                        </action>
                    </button>

                    <datatable onBeforeRender="setContraetiquetasNumeracionesSinUtilizar"
                        route="numeracionContraetiquetado-editNumeracionContraetiquetado"
                        numVisibleRows="3"
                        repo="numeracionContraetiquetadoRepo"
                        allowsPartialRestore="false">
                        <column headerText="Etiquetado desde" filtering="false" ordering="true" value="${entity.etiqueta_desde}">
                            <order property="etiqueta_desde"/>
                        </column>
                        <column headerText="Desde" filtering="false" ordering="true" value="${entity.desde}">
                            <order property="desde"/>
                        </column>
                        <column headerText="Etiquetado hasta" filtering="false" ordering="true" value="${entity.etiqueta_hasta}">
                            <order property="etiqueta_hasta"/>
                        </column>
                        <column headerText="Hasta" filtering="false" ordering="true" value="${entity.hasta}">
                            <order property="hasta"/>
                        </column>
                        <column headerText="Unidades" filtering="false" ordering="true" value="${entity.unidades}">
                            <order property="hasta"/>
                        </column>
                        <param name="expediente_id" value="${view.expediente_id}" />
                        <param name="num_expediente" value="${view.num_expediente}" />
                        <param name="operador_id" value="${view.operador_id}"/>
                        <param name="razon_social" value="${view.razon_social}"/>
                        <param name="dop_id" value="${view.dop_id}"/>
                        <param name="dop" value="${view.dop}"/>
                        <param name="trazabilidad_id" value="${view.trazabilidad_id}"/>
                        <param name="partida" value="${view.partida}"/>
                        <param name="asignada" value="N"/>
                        <repofilter>
                            <and>
                                <eq property="trazabilidad_id" value="${empty(entity.trazabilidad_id) ? '-1' : entity.trazabilidad_id}" />
                                <eq property="asignada" value="N" />
                            </and>
                        </repofilter>
                    </datatable>

                    <table border="false" weights="30, 70">
                        <row>
                            <p bold="true" value="Existencia en bodega de contras sin utilizar: " readonly="true"/>
                            <input id="contras_sin_usar" allowsPartialRestore="false" value="${entity.contras_sin_usar}" readonly="true"/>
                        </row>
                    </table>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Vino etiquetado/contraetiquetado"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <input id="cantidad_vino_etiquetado" label="Cantidad (litros): " value="${entity.cantidad_vino_etiquetado}" inputType="3"/>
                            <input id="capacidad_botella" label="Capacidad de botella: " value="${entity.capacidad_botella}" inputType="3"/>
                            <input id="numero_botellas" label="Número de botellas: " value="${(view.cantidad_vino_etiquetado gt 0 and view.capacidad_botella gt 0)?math:floor(view.cantidad_vino_etiquetado/view.capacidad_botella):null}" inputType="3" readonly="true"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Balance"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <!--<input label="Diferencia contraetiquetas: " value="${view.cantidad_vino_etiquetado gt 0 and view.capacidad_botella gt 0 and view.contras_usadas gt 0?math:ceil(view.cantidad_vino_etiquetado/view.capacidad_botella)-entity.contras_usadas:null}" inputType="3" readonly="true"/>-->
                            <input allowsPartialRestore="false" readonly="true" value="${(view.cantidad_vino_etiquetado gt 0 and view.capacidad_botella gt 0)?math:floor(view.cantidad_vino_etiquetado/view.capacidad_botella) - view.contras_usadas:null}"/>
                            <textarea label="Observaciones" value="${entity.observaciones_balance}"/>
                        </row>
                        <row>
                            <input label="Balance uso de contras: " allowsPartialRestore="false" readonly="true" value="${view.numero_botellas + view.contras_sin_usar}"/>
                        </row>
                    </table>

                    <!--<divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Requisitos de etiquetado"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <radio label="Cumple: " value="${entity.cumple_requisitos_etiquetado}" orientation="horizontal"  weights="25, 25">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                        </row>
                    </table>-->

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Vino embotellado"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <input label="Cantidad (L): " value="${entity.cantidad_vino_embotellado}" inputType="3"/>
                            <date label="Fecha: " value="${entity.fecha_vino_embotellado}"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Vino existente  en Aforo de la partida calificada"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <input label="Granel  (litros): " value="${entity.cantidad_vino_aforo}" inputType="3"/>
                            <input label="Embotellado (litros): " value="${entity.cantidad_vino_embotellado}" inputType="3"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Salidas (L) partida verificada"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <input label="Salidas (L): " value="${entity.salidas_partida_verificada}" inputType="3"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Descripción de movimientos entre depósitos intermedios"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <textarea label="Descripción: " value="${entity.descripcion_movimientos_depositos}"/>
                        </row>
                    </table>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Envejecimiento barricas y botellas"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <date id="fecha_llenado_barricas" label="F. llenado barricas: " value="${entity.fecha_llenado_barricas}" hasTodayButton="false"/>
                            <date id="fecha_salida_barricas" label="F. salida barricas: " value="${entity.fecha_salida_barricas}" hasTodayButton="false"/>
                            <date id="fecha_llenado_botella" label="F. llenado botellas: " value="${entity.fecha_llenado_botella}" hasTodayButton="false" render="${math:round(view.tipo_envejecimiento_id) ge 3}"/>
                            <date id="fecha_calificacion_botella" label="F. calificación botellas: " value="${entity.fecha_calificacion_botella}" hasTodayButton="false" render="${math:round(view.tipo_envejecimiento_id) ge 3}"/>
                            <date id="fecha_primera_salida_comercializada" label="F. salida comercializada: " value="${entity.fecha_primera_salida_comercializada}" hasTodayButton="false" render="${math:round(view.tipo_envejecimiento_id) le 2}"/>
                        </row>
                        <row>
                            <autocomplete label="Tipo envejecimiento: " forceSelection="true" id="tipo_envejecimiento_id" repo="tipoEnvejecimientoRepo" value="${entity.tipo_envejecimiento_id}">
                                <options labelExpression="${entity.tipo_envejecimiento}" labelFilteringProperty="tipo_envejecimiento" valueProperty="tipo_envejecimiento_id" />
                                <repofilter>
                                    <contains property="tipo_envejecimiento" value="${this.value}"/>
                                </repofilter>
                            </autocomplete>
                            <p value=""/>
                            <p value=""/>
                        </row>
                        <row weights="30, 40, 30, 30, 40, 30">
                            <input id="tiempo_botella" label="Meses en botella: " value="${view.fecha_llenado_botella+''+view.fecha_calificacion_botella}" onBeforeRender="updateTiempoBotella" readonly="true" render="${math:round(view.tipo_envejecimiento_id) ge 3}"/>
                            <input id="meses_botella" label="Periodo mínimo envejecimento botellas: " value="${view.tipo_envejecimiento_id}" onBeforeRender="updateMesesBotella" readonly="true" render="${math:round(view.tipo_envejecimiento_id) ge 3}"/>
                            <!--radio id="cumple_envejecimiento_botella" label="Cumple envejecimiento botella: " value="${not empty(view.meses_botella) and not empty(view.tiempo_botella) and view.meses_botella le view.tiempo_botella?'SI':'NO'}" orientation="horizontal" readonly="true">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio-->
                            <radio id="cumple_envejecimiento_botella" label="Cumple envejecimiento botella: " value="${view.fecha_llenado_botella+''+view.fecha_calificacion_botella+''+view.tipo_envejecimiento_id}" orientation="horizontal" onBeforeRender="updateCumpleEnvejecimientoBotella" readonly="true" render="${math:round(view.tipo_envejecimiento_id) ge 3}">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>

                            <input id="tiempo_bodega" label="Meses en bodega: " value="${view.fecha_llenado_barricas+''+view.fecha_primera_salida_comercializada}" onBeforeRender="updateTiempoBodega" readonly="true" render="${math:round(view.tipo_envejecimiento_id) le 2}"/>
                            <input id="meses_bodega" label="Periodo mínimo envejecimento botellas: " value="${view.tipo_envejecimiento_id}" onBeforeRender="updateMesesBotella" readonly="true" render="${math:round(view.tipo_envejecimiento_id) le 2}"/>
                            <!--radio id="cumple_envejecimiento_botella" label="Cumple envejecimiento botella: " value="${not empty(view.meses_botella) and not empty(view.tiempo_botella) and view.meses_botella le view.tiempo_botella?'SI':'NO'}" orientation="horizontal" readonly="true">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio-->
                            <radio id="cumple_permanencia_vino_bodega" label="Cumple permanencia vino bodega: " value="${view.fecha_llenado_barricas+''+view.fecha_primera_salida_comercializada+''+view.tipo_envejecimiento_id}" orientation="horizontal" onBeforeRender="updateCumplePermanenciaVinoBodega" readonly="true" render="${math:round(view.tipo_envejecimiento_id) le 2}">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                        </row>

                        <row weights="30, 40, 30">
                            <input id="tiempo_en_barrica" label="Meses en barrica: " value="${view.fecha_llenado_barricas+''+view.fecha_salida_barricas}" onBeforeRender="updateTiempoBarrica" readonly="true"/>
                            <input id="meses_en_barrica" label="Periodo mínimo envejecimento barricas: " value="${view.tipo_envejecimiento_id}" onBeforeRender="updateMesesBarrica" readonly="true"/>
                            <!--radio id="cumple_envejecimiento_barrica" label="Cumple envejecimiento barrica: " value="${not empty(view.meses_en_barrica) and not empty(view.tiempo_en_barrica) and  view.tiempo_en_barrica gt view.meses_en_barrica?'SI':'NO'}" orientation="horizontal" readonly="true">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio-->
                            <radio id="cumple_envejecimiento_barrica" label="Cumple envejecimiento barrica: " value="${view.fecha_llenado_barricas+''+view.fecha_salida_barricas+''+view.tipo_envejecimiento_id}" orientation="horizontal" onBeforeRender="updateCumpleEnvejecimientoBarrica" readonly="true">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                        </row>
                        <row weights="70, 30">
                            <textarea label="Observaciones: " value="${entity.observaciones_envejecimiento}"/>
                            <radio label="Cumple envejecimiento: " value="${view.cumple_envejecimiento_barrica+''+view.cumple_permanencia_vino_bodega+''+view.cumple_envejecimiento_botella}" orientation="horizontal" readonly="true" onBeforeRender="updateCumpleEnvejecimientoTotal">
                                <options>
                                    <option label="SI" value="SI" />
                                    <option label="NO" value="NO" />
                                </options>
                            </radio>
                        </row>
                    </table>


                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Vino elaborado"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <table border="false">
                        <row>
                            <input label="Cantidad (L): " value="${entity.cantidad_vino_elaborado}" inputType="3"/>
                            <date label="Fecha elaboración: " value="${entity.fecha_elaboracion}"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Mosto (L)"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <input label="Cantidad: " value="${entity.cantidad_mosto}" inputType="3"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Uva (kg)"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <input label="Cantidad: " value="${entity.cantidad_uva}" inputType="3"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Foto botella trazada"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <table border="false">
                        <row>
                            <table border="false" weights="30, 20, 50">
                                <row>
                                    <p bold="true" value="Foto: "/>
                                    <switcher id="switcherImagenBotella" value="${not empty(entity.imagen_botella)?1:0}"/>
                                </row>
                            </table>
                            <table border="false" weights="10, 90">
                                <row>
                                    <image converter="b64Image" embedded="true" value="${entity.imagen_botella}" render="${view.switcherImagenBotella eq 'true'}" hasDeleteButton="false" inputType="5"/>
                                </row>
                            </table>
                        </row>
                    </table>
            </tabitem>

            <tabitem label="ENTRADA DE UVA">
                <table border="false">
                    <row>
                        <button label="Entrada de uva" readonly="${empty (entity.trazabilidad_id)}">
                            <action type="save" route="entradaUva-editEntradaUva">
                                <param name="expediente_id" value="${view.expediente_id}" />
                                <param name="num_expediente" value="${view.num_expediente}" />
                                <param name="operador_id" value="${view.operador_id}"/>
                                <param name="razon_social" value="${view.razon_social}"/>
                                <param name="dop_id" value="${view.dop_id}"/>
                                <param name="dop" value="${view.dop}"/>
                                <param name="trazabilidad_id" value="${view.trazabilidad_id}"/>
                                <param name="partida" value="${view.partida}"/>
                            </action>
                        </button>
                    </row>
                </table>

                <datatable
                    numVisibleRows="4"
                    repo="entradaUvaRepo"
                    route="entradaUva-editEntradaUva">
                    <column id="column_fecha_entrada" headerText="Fecha entrada" filtering="true" ordering="true" value="${entity.fecha_entrada}">
                        <filter property="fecha_entrada" matching="contains" valueExpression="${this.column_fecha_entrada}"/>
                        <order property="fecha_entrada"/>
                    </column>
                    <param name="expediente_id" value="${view.expediente_id}" />
                    <param name="num_expediente" value="${view.num_expediente}" />
                    <param name="operador_id" value="${view.operador_id}"/>
                    <param name="razon_social" value="${view.razon_social}"/>
                    <param name="dop_id" value="${view.dop_id}"/>
                    <param name="dop" value="${view.dop}"/>
                    <param name="trazabilidad_id" value="${view.trazabilidad_id}"/>
                    <param name="partida" value="${view.partida}"/>
                    <repofilter>
                        <and>
                            <eq property="trazabilidad_id" value="${empty(entity.trazabilidad_id) ? '-1' : entity.trazabilidad_id}" />
                        </and>
                    </repofilter>
                </datatable>
            </tabitem>
            <tabitem label="CONTROL ETIQUETADO" onBeforeRender="anadirDescripcion">
                <p value=""/>
                <divisor color="#00766C" strokeWidth="10" />
                <p bold="true" value="INDICACIONES OBLIGATORIAS(Reglamento 1308/2013)" fontSize="20"/>
                <divisor color="#00766C" strokeWidth="10" />

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="DENOMINACIÓN DEL PRODUCTO"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_denominacion_producto}" orientation="horizontal" hint="${entity.desc_denominacion_producto}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_denominacion_producto}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="GRADO ALCOHÓLICO"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_grado_alcoholico}" orientation="horizontal" hint="${entity.desc_grado_alcoholico}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_grado_alcoholico}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="PROCEDENCIA"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_procedencia}" orientation="horizontal" hint="${entity.desc_procedencia}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_procedencia}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="EMBOTELLADO POR O EMBOTELLADOR"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_embotellado_por}" orientation="horizontal" hint="${entity.desc_embotellado_por}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_embotellado_por}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="EMBOTELLADO POR ENCARGO"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_embotellado_por_encargo}" orientation="horizontal" hint="${entity.desc_embotellado_por_encargo}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_embotellado_por_encargo}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="IMPORTADOR"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_importador}" orientation="horizontal" hint="${entity.desc_importador}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_importador}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="VOLUMEN NOMINAL"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_volumen_nominal}" orientation="horizontal" hint="${entity.desc_volumen_nominal}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_volumen_nominal}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="10" />
                <p bold="true" value="OTRAS INDICACIONES OBLIGATORIAS" fontSize="20"/>
                <divisor color="#00766C" strokeWidth="10" />

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="Nº DE REGISTRO DE EMBOTELLADOR"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_num_registro_embotellador}" orientation="horizontal" hint="${entity.desc_num_registro_embotellador}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_num_registro_embotellador}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="ALERGENOS-CONTIENE SULFITOS"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_alergenos}" orientation="horizontal" hint="${entity.desc_alergenos}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_alergenos}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="Nº DE LOTE"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_num_lote}" orientation="horizontal" hint="${entity.desc_num_lote}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_num_lote}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="PUNTO VERDE"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_punto_verde}" orientation="horizontal" hint="${entity.desc_punto_verde}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_punto_verde}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="10" />
                <p bold="true" value="INDICACIONES FACULTATIVAS  (ART. 120 DE RGTO 1308/2013)" fontSize="20"/>
                <divisor color="#00766C" strokeWidth="10" />

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="AÑO DE LA COSECHA, AÑADA, VENDIMIA"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_ano_cosecha}" orientation="horizontal" hint="${entity.desc_ano_cosecha}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_ano_cosecha}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="VARIEDADES DE VID"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_variedades_vid}" orientation="horizontal" hint="${entity.desc_variedades_vid}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_variedades_vid}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="MENCIONES TRADICIONALES"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_menciones_tradicionales}" orientation="horizontal" hint="${entity.desc_menciones_tradicionales}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_menciones_tradicionales}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="CONTENIDO EN AZÚCAR"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_contenido_azucar}" orientation="horizontal" hint="${entity.desc_contenido_azucar}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_contenido_azucar}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="SÍMBOLO COMUNITARIO DE DOP/IGP"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_simbolo_comunitario}" orientation="horizontal" hint="${entity.desc_simbolo_comunitario}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_simbolo_comunitario}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="MÉTODOS DE PRODUCCIÓN (FERMENTADO EN BARRICA o ROBLE)"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_metodos_produccion}" orientation="horizontal" hint="${entity.desc_metodos_produccion}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_metodos_produccion}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="MÉTODOS DE PRODUCCIÓN ECOLÓGICOS"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_metodos_ecologicos}" orientation="horizontal" hint="${entity.desc_metodos_ecologicos}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_metodos_ecologicos}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="UNIDAD GEOGRÁFICA MENOR O MAYOR VINO DE PUEBLO + TÉRMINO MUNICIPAL O ENTIDAD LOCAL MENOR"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_unidad_geografica}" orientation="horizontal" hint="${entity.desc_unidad_geografica}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_unidad_geografica}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="10" />
                <p bold="true" value="OTRAS INDICACIONES FACULTATIVAS" fontSize="20"/>
                <divisor color="#00766C" strokeWidth="10" />

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="EXPLOTACIÓN VITÍCOLA"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_explotacion_viticola}" orientation="horizontal" hint="${entity.desc_explotacion_viticola}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_explotacion_viticola}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="MENCIONES RELATIVAS AL COLOR"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_menciones_color}" orientation="horizontal" hint="${entity.desc_menciones_color}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_menciones_color}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="SÍMBOLO CE 'E'"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_simbolo_ce}" orientation="horizontal" hint="${entity.desc_simbolo_ce}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_simbolo_ce}"/>
                    </row>
                </table>

                <p value=""/>
                <divisor color="#00766C" strokeWidth="8" />
                <p bold="true" value="MARCA"/>
                <divisor color="#00766C" strokeWidth="8" />
                <table weights="30, 70">
                    <row>
                        <radio label="Cumple: " value="${entity.cumple_marca}" orientation="horizontal" hint="${entity.desc_marca}">
                            <options>
                                <option label="SI" value="SI" />
                                <option label="NO" value="NO" />
                            </options>
                        </radio>
                        <textarea label="Observaciones: " value="${entity.observaciones_etiquetado_marca}"/>
                    </row>
                </table>
            </tabitem>
            </tab>

        </form>

        <buttonbar type="bottom">
            <button label="Save">
                <action type="save" route="back" registerInHistory="false" restoreView="true">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>

            <button label="Cancel">
                <action type="cancel" route="back" restoreView="true">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>

            <button label="Delete" readonly="${empty (entity.trazabilidad_id)}" readonlyMessage="No puede realizar esta acción: No existe trazabilidad" restoreView="true">
                <action type="delete" route="back" registerInHistory="false">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>
        </buttonbar>
    </edit>
</main>
