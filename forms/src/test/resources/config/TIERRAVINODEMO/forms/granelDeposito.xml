<main id="granelDeposito" name="Granel Depósito" repo="granelDepositoRepo" mainForm="false">
    <list id="listGranelDeposito" name="Granel Depósito" description="Listado graneles depósito">
       <datatable>
           <column headerText="Nº Depósito" filtering="false" ordering="false" value="${entity.deposito.numero}"/>
           <column headerText="Partida" filtering="false" ordering="false" value="${entity.partidaAforo.partida}"/>
           <column headerText="Añada" filtering="false" ordering="false" value="${entity.partidaAforo.anada}"/>
           <column id="column_volumen_nominal_granel_deposito" headerText="Volumen nominal" filtering="true" ordering="true" value="${entity.volumen_nominal}">
               <filter property="volumen_nominal" matching="contains" valueExpression="${this.column_volumen_nominal_granel_deposito}"/>
               <order property="volumen_nominal"/>
           </column>
           <column id="column_volumen_aforado_granel_deposito" headerText="Volumen aforado" filtering="true" ordering="true" value="${entity.volumen_aforado}">
               <filter property="volumen_aforado" matching="contains" valueExpression="${this.column_volumen_aforado_granel_deposito}"/>
               <order property="volumen_aforado"/>
           </column>
           <column headerText="Tipo de vino" filtering="false" ordering="false" value="${entity.partidaAforo.vino.vino}"/>
           <column headerText="Nivel de protección" filtering="false" ordering="false" value="${entity.partidaAforo.nivelProteccion.nivel_proteccion}"/>
           <column headerText="Tipo de depósito" filtering="false" ordering="false" value="${entity.tipoDeposito.tipo_deposito}"/>
           <column headerText="Material" filtering="false" ordering="false" value="${entity.material.material}"/>
           <column id="column_observaciones_granel_deposito" headerText="Observaciones" filtering="true" ordering="true" value="${entity.observaciones}">
               <filter property="observaciones" matching="contains" valueExpression="${this.column_observaciones_granel_deposito}"/>
               <order property="observaciones"/>
           </column>
       </datatable>
        <buttonbar type="fab"/>
    </list>
    <edit id="editGranelDeposito">
        <form id="formGranelDeposito">

            <p value=""/>
            <p backgroundColor="#26a69a" fontSize="22" fontColor="#FFFFFF" bold="true" value="GRANEL DEPÓSITO"/>

            <table headerText=" Id. Exp., Nº Exp., Id. DOP, DOP" weights="20, 30, 10, 40">
                <row>
                    <input id="expediente_id" value="${entity.partidaAforo.expediente_id}" placeHolder="${params.expediente_id}" readonly="true"/>
                    <input id="num_expediente" value="${entity.partidaAforo.expediente.num_expediente}" placeHolder="${params.num_expediente}" readonly="true"/>
                    <input id="dop_id" value="${entity.partidaAforo.expediente.dop_id}" placeHolder="${params.dop_id}" readonly="true"/>
                    <input id="dop" value="${entity.partidaAforo.expediente.dop.dop}" placeHolder="${params.dop}" readonly="true"/>
                </row>
            </table>
            <table headerText=" Id. Operador, Razón social" weights="20, 80">
                <row>
                    <input id="operador_id" value="${entity.partidaAforo.expediente.operador_id}" placeHolder="${params.operador_id}" readonly="true"/>
                    <input id="razon_social" value="${entity.partidaAforo.expediente.operador.razon_social}" placeHolder="${params.razon_social}" readonly="true"/>
                </row>
            </table>

            <table headerText=" Id. partida, Partida, Añada" weights="20, 50, 30">
                <row>
                    <input id="partida_aforo_id" value="${entity.partida_aforo_id}" placeHolder="${params.partida_aforo_id}" readonly="true"/>
                    <input id="partida" value="${entity.partidaAforo.partida}" placeHolder="${params.partida}" readonly="true"/>
                    <input id="anada" value="${entity.partidaAforo.anada}" placeHolder="${params.anada}" readonly="true"/>
                </row>
            </table>

            <table headerText=" Id. Nivel, Nivel de protección, Id Tipo, Tipo de vino" weights="20, 30, 20, 30">
                <row>
                    <input id="nivel_proteccion_id" value="${entity.partidaAforo.nivel_proteccion_id}" placeHolder="${params.nivel_proteccion_id}" readonly="true"/>
                    <input id="nivel_proteccion" value="${entity.partidaAforo.nivelProteccion.nivel_proteccion}" onBeforeRender="updateNivelProteccion" readonly="true"/>
                    <input id="vino_id" value="${entity.partidaAforo.vino_id}" placeHolder="${params.vino_id}" readonly="true"/>
                    <input id="vino" value="${entity.partidaAforo.vino.vino}"  onBeforeRender="updateTipoVino" readonly="true"/>
                </row>
            </table>

            <p value=""/>
            <divisor color="#00766C" strokeWidth="8" />
            <p bold="true" value="Granel-depósito"/>
            <divisor color="#00766C" strokeWidth="8" />

            <table border="false">
                <row weights="25, 25, 50">
                    <input label="Id.: " id="granel_deposito_id" value="${entity.granel_deposito_id}" readonly="true"/>
                    <autocomplete label="Deposito: " forceSelection="true" id="deposito_id" repo="depositoRepo" value="${entity.deposito_id}" validator="required">
                        <options labelExpression="${entity.numero}" labelFilteringProperty="numero" valueProperty="deposito_id" />
                        <repofilter>
                            <eq property="operador_id" value="${view.operador_id}" mandatory="true"/>
                            <contains property="numero" value="${this.value}"/>
                        </repofilter>
                    </autocomplete>
                    <autocomplete label="Tipo de depósito: " forceSelection="true" id="tipo_deposito_id" repo="tipoDepositoRepo" value="${entity.tipo_deposito_id}">
                        <options labelExpression="${entity.tipo_deposito}" labelFilteringProperty="tipo_deposito" valueProperty="tipo_deposito_id" />
                        <repofilter>
                            <contains property="tipo_deposito" value="${this.value}"/>
                        </repofilter>
                    </autocomplete>
                </row>
                <row>
                    <textarea label="Material: " value="${view.deposito_id}" onBeforeRender="updateMaterialDeposito" readonly="true"/>
                </row>
                <row>
                    <input label="Volumen nominal: " value="${view.deposito_id}" onBeforeRender="updateVolumenNominal" inputType="3" readonly="true"/>
                    <input label="Volumen aforado: " value="${entity.volumen_aforado}" inputType="3"/>
                </row>
                <row>
                    <textarea label="Observaciones: " value="${entity.observaciones}" />
                </row>
                <row>
                    <table border="false" weights="10, 35, 10, 35, 10">
                        <row>
                            <p value=""/>
                            <button label="Detalle depósito">
                                <action type="save" route="deposito-editDeposito">
                                    <param name="entityId" value="${view.deposito_id}" />
                                    <param name="granel_deposito_id" value="${entity.granel_deposito_id}" />
                                    <param name="operador_id" value="${view.operador_id}" />
                                    <param name="razon_social" value="${view.razon_social}" />
                                </action>
                            </button>
                            <p value=""/>
                            <button label="Nuevo depósito">
                                <action type="nav" route="deposito-editDeposito">
                                    <param name="operador_id" value="${view.operador_id}" />
                                    <param name="razon_social" value="${view.razon_social}" />
                                </action>
                            </button>
                            <p value=""/>
                        </row>
                    </table>
                </row>
            </table>

        </form>

        <buttonbar type="bottom">
            <button label="Save">
                <action type="save" route="back" registerInHistory="false" restoreView="true">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>

            <button label="Cancel">
                <action type="cancel" route="back" restoreView="true">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>

            <button label="Delete" readonly="${empty (entity.granel_deposito_id)}" readonlyMessage="No puede realizar esta acción: No existe granel depósito" restoreView="true">
                <action type="delete" route="back" registerInHistory="false">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>
        </buttonbar>
    </edit>
</main>
