<main name="Inspecciones" id="inspeccion" repo="inspeccionRepo">
    <list name="INSPECCIONES" description="Listado de Inspecciones">
        <datatable route="inspeccion-editInspeccion">
            <column filtering="true" headerText="Identidicador" id="column_inspeccion"
                ordering="true" value="${entity.c_accion_singra_id}">
                <filter matching="contains" property="c_accion_singra_id"
                    valueExpression="${this.column_inspeccion}" />
                <order property="c_accion_singra_id" />
            </column>
            <column filtering="true" headerText="Inspección" id="column_c_inspeccion"
                ordering="true" value="${entity.c_inspeccion}">
                <filter matching="contains" property="c_inspeccion"
                    valueExpression="${this.column_c_inspeccion}" />
                <order property="c_inspeccion" />
            </column>
            <column filtering="true" headerText="Nombre entidad" id="column_nombre_entidad"
                ordering="true" value="${entity.d_nombre_entidad}">
                <filter matching="contains" property="d_nombre_entidad"
                    valueExpression="${this.column_nombre_entidad}" />
                <order property="d_nombre_entidad" />
            </column>
            <column filtering="true" headerText="CIF entidad" id="column_cif_entidad"
                ordering="true" value="${entity.d_cif_entidad}">
                <filter matching="contains" property="d_cif_entidad"
                    valueExpression="${this.column_cif_entidad}" />
                <order property="d_cif_entidad" />
            </column>
            <column id="column_b_cancelada" filtering="false" ordering="false" headerText="Cancelada" value="${entity.b_cancelada == 1?'Sí':'No'}"/>
            <column id="column_b_firmado" filtering="false" ordering="false" headerText="Inspeccionada" value="${entity.b_firmado == 1?'Sí':'No'}"/>
        </datatable>
        <buttonbar type="fab" />
    </list>

    <edit id="editInspeccion">
        <script src="scripts/control.js"/>
        <form id="formInspeccion">
            <p value="" />
            <p backgroundColor="#26a69a" bold="true" fontColor="#FFFFFF" fontSize="22"
                value="INSPECCIÓN" />
            <table border="false">
                <row colspan="50, 25, 25">
                    <p value=""/>
                    <button label="Generar informe" render="${not empty(view.b_conforme) and not empty(view.firma_responsable)}">
                        <action id="compositeAction3">
                            <action
                                controller="datalistControlDocInspeccionTipo5,datalistControlCuestionario,formInspeccion, datalistRegistrosEmbotelladores, datalistRegistrosSanitarios, datalistFigurasCalidad"
                                registerInHistory="false" type="save">
                                <param name="inspeccion" value="${view.inspeccion}" />
                            </action>
                            <action type="js" route="back">
                                <param name="method" value="setInspeccionadaInspeccion" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            </action>
                            <action type="js">
                                <param name="method" value="setDFichero" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            </action>
                            <action registerInHistory="false" type="job">
                                <param name="jobId" value="job_generar_informe_inspeccion" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                <param name="c_cuestionario_respondido" value="${entity.c_cuestionario_respondido}" />
                                <param name="previa" value="NO" />
                                <param name="d_fichero" value="${entity.d_fichero}" />
                            </action>
                        </action>
                    </button>
                    <button label="Cancelar inspección" confirmation="true" labelConfirmation="Se va a cancelar la inspección. ¿Desea continuar?"
                        route="back">
                        <action id="compositeAction">
                            <action type="js" route="back" registerInHistory="false">
                                <param name="method" value="cancelarInspeccion" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            </action>
                        </action>
                    </button>
                </row>
            </table>
            <tab>
                <tabitem label="ENTIDAD">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos básicos de la entidad:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="80, 20">
                            <input label="Entidad: " value="${entity.d_nombre_entidad}" readonly="true"/>
                            <input label="CIF: " value="${entity.d_cif_entidad}" readonly="true"/>
                        </row>
                        <row>
                            <input label="Domicilio: " value="${entity.d_dir_social}" readonly="true"/>
                        </row>
                    </table>
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos del Representante legal:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="40, 40, 20">
                            <input label="Nombre: " value="${entity.d_repr_nombre_entidad}" readonly="true" />
                            <input label="Apellidos: " value="${entity.d_repr_apell_entidad}" readonly="true"/>
                            <input label="NIF: " value="${entity.d_repr_nif_entidad}" readonly="true"/>
                        </row>
                    </table>
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea lines="6" value="${entity.d_obs_entidad}" readonly="${entity.b_firmado == 1}"/>
                </tabitem>
                <tabitem label="INSTALACIÓN">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos de la instalación:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="80, 20">
                            <input label="Instalación: " value="${entity.d_nombre_instalacion}" readonly="true"/>
                            <input label="CIF: " value="${entity.d_cif_instalacion}" readonly="true"/>
                        </row>
                        <row>
                            <input label="Domicilio: " value="${entity.d_dir_industrial}" readonly="true"/>
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos del Responsable:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="40, 40, 20">
                            <input id="nombre_responsable" label="Nombre: " value="${entity.d_repr_nombre_instal}" readonly="${entity.b_firmado == 1}" validator="required">
                                <action type="js">
                                    <param name="method" value="updateResponsable"/>
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_responsable" value="${view.nombre_responsable}" />
                                    <param name="apellidos_responsable" value="${view.apellidos_responsable}" />
                                </action>
                            </input>
                            <input id="apellidos_responsable" label="Apellidos: " value="${entity.d_repr_apellidos_instal}" readonly="${entity.b_firmado == 1}" validator="required">
                                <action type="js">
                                    <param name="method" value="updateResponsable" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_responsable" value="${view.nombre_responsable}" />
                                    <param name="apellidos_responsable" value="${view.apellidos_responsable}" />
                                </action>
                            </input>
                            <input id="nif_responsable" label="NIF: " value="${entity.d_repr_nif_instal}" readonly="${entity.b_firmado == 1}" validator="required"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="10"/>
                    <p bold="true" fontSize="18" value="Registros de Empresas y Actividades Alimentarias de CyL (RAAL):"/>
                    <divisor color="#00766C" strokeWidth="10"/>
                    <datalist id="datalistRegistrosSanitarios" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra}" />
                                <eq property="c_tipo_doc" value="4" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemRegistrosSanitarios">

                            <table weights="70, 30">
                                <row>
                                    <input id="nombreRegistroSanitario" label="Registro sanitario: " value="${entity.d_nombre}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                    <date id="f_inicio_validez_registro_sanitario" converter="long" pattern="unixepoch_s" label="Fecha inicio: " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                </row>
                            </table>
                        </datalistitem>
                    </datalist>
                    <p value="No existen registros sanitarios" italic="true" onBeforeRender="countRegistrosSanitarios"/>
                    <p value=""/>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Registros embotelladores:" />
                    <divisor color="#00766C" strokeWidth="10"/>
                    <datalist id="datalistRegistrosEmbotelladores" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra}" />
                                <eq property="c_tipo_doc" value="10" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemRegistrosEmbotelladores">
                            <table weights="70, 30">
                                <row>
                                    <input id="nombreRegistroEmbotellador" label="Registro embotellador: " value="${entity.d_nombre}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                    <date id="f_inicio_validez_registro_embotellador" converter="long" pattern="unixepoch_s" label="Fecha inicio: " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                </row>
                            </table>
                        </datalistitem>
                    </datalist>
                    <p value="No existen registros embotelladores" italic="true" onBeforeRender="countRegistrosEmbotelladores"/>
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea lines="3" value="${entity.d_obs_instalacion}" readonly="${entity.b_firmado == 1}"/>
                </tabitem>
                <tabitem label="INSPECTORES">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos básicos de los inspectores:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="40, 60">
                            <input id="nombre_inspector1" label="Nombre 1: " value="${entity.d_nombre_inspector1}" readonly="${entity.b_firmado == 1}" validator="required">
                                <action type="js">
                                    <param name="method" value="updateInspector1" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_inspector" value="${view.nombre_inspector1}" />
                                    <param name="apellidos_inspector" value="${view.apellidos_inspector1}" />
                                </action>
                            </input>
                            <input id="apellidos_inspector1" label="Apellidos 1: " value="${entity.d_apellidos_inspector1}" readonly="${entity.b_firmado == 1}" validator="required">
                                <action type="js">
                                    <param name="method" value="updateInspector1" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_inspector" value="${view.nombre_inspector1}" />
                                    <param name="apellidos_inspector" value="${view.apellidos_inspector1}" />
                                </action>
                            </input>
                        </row>
                    </table>
                    <table border="false">
                        <row weights="40, 60">
                            <input id="nombre_inspector2" label="Nombre 2: " value="${entity.d_nombre_inspector2}" readonly="${entity.b_firmado == 1}">
                                <action type="js">
                                    <param name="method" value="updateInspector2" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_inspector" value="${view.nombre_inspector2}" />
                                    <param name="apellidos_inspector" value="${view.apellidos_inspector2}" />
                                </action>
                            </input>
                            <input id="apellidos_inspector2" label="Apellidos 2: " value="${entity.d_apellidos_inspector2}" readonly="${entity.b_firmado == 1}">
                                <action type="js">
                                    <param name="method" value="updateInspector2" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_inspector" value="${view.nombre_inspector2}" />
                                    <param name="apellidos_inspector" value="${view.apellidos_inspector2}" />
                                </action>
                            </input>
                        </row>
                    </table>
                    <table border="false">
                        <row weights="40, 60">
                            <input id="nombre_inspector3" label="Nombre 3: " value="${entity.d_nombre_inspector3}" readonly="${entity.b_firmado == 1}">
                                <action type="js">
                                    <param name="method" value="updateInspector3" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_inspector" value="${view.nombre_inspector3}" />
                                    <param name="apellidos_inspector" value="${view.apellidos_inspector3}" />
                                </action>
                            </input>
                            <input id="apellidos_inspector3" label="Apellidos 3: " value="${entity.d_apellidos_inspector3}" readonly="${entity.b_firmado == 1}">
                                <action type="js">
                                    <param name="method" value="updateInspector3" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="nombre_inspector" value="${view.nombre_inspector3}" />
                                    <param name="apellidos_inspector" value="${view.apellidos_inspector3}" />
                                </action>
                            </input>
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Fecha comunicación:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <date id="f_comunicacion" converter="long" pattern="unixepoch_s" label="Fecha comunicación: "
                        value="${entity.f_comunicacion}" readonly="${entity.b_firmado == 1}" validator="required"/>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea lines="10" value="${entity.d_obs_inspector}" readonly="${entity.b_firmado == 1}"/>
                </tabitem>
                <tabitem label="EXPEDIENTE">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Productos y marca autorizados:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <datalist id="datalistControlDocInspeccionTipo5" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra}" />
                                <eq property="c_tipo_doc" value="5" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemProductosYMarcasAutorizados">
                            <table weights="50, 25, 25">
                                <row>
                                    <input label="Marca: " value="${entity.d_nombre}" readonly="true"/>
                                    <date id="f_inicio_validez_producto_y_marca" converter="long" pattern="unixepoch_s" label="Válido desde " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                    <date id="f_fin_validez_producto_y_marca" converter="long" pattern="unixepoch_s" label="hasta el " value="${entity.f_fin_validez}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                </row>
                                <row>
                                    <textarea label="Producto:" value="${entity.d_observaciones}" readonly="true"/>
                                </row>
                            </table>
                            <p value="" />
                        </datalistitem>
                    </datalist>
                    <p value="No existen productos y marcas autorizados" italic="true" onBeforeRender="countProductosYMarcasAutorizados"/>
                    <p value=""/>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Figuras de calidad:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <datalist id="datalistFigurasCalidad" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra}" />
                                <eq property="c_tipo_doc" value="6" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemFigurasCalidad">
                            <table weights="50, 25, 25">
                                <row>
                                    <input id="nombreFiguracalidad" label="Figura de calidad: " value="${entity.d_nombre}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                    <date id="f_inicio_validez_figura_calidad" converter="long" pattern="unixepoch_s" label="Fecha inicio: " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                    <date id="f_fin_validez_figura_calidad" converter="long" pattern="unixepoch_s" label="Fecha fin: " value="${entity.f_fin_validez}" readonly="${entity.inspeccion.b_firmado == 1}" validator="required"/>
                                </row>
                            </table>
                        </datalistitem>
                    </datalist>
                    <p value="No existen figuras de calidad" italic="true" onBeforeRender="countFigurasDeCalidad"/>
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea lines="5" value="${entity.d_obs_documentos}" readonly="${entity.b_firmado == 1}"/>
                </tabitem>
                <tabitem label="CUESTIONARIO">

                    <datalist id="datalistControlCuestionario" repo="respuestaRespondidaRepo">
                        <repofilter>
                            <and>
                                <eq property="c_cuestionario_respondido" value="${entity.c_cuestionario_respondido}" />
                            </and>
                        </repofilter>
                        <datalistitem>
                            <table>
                                <row>
                                    <radio id="respuestaLabel" orientation="horizontal" label="${entity.respuesta.pregunta.d_pregunta}" validator="required"
                                        value="${entity.d_respuesta}" readonly="${entity.inspeccion.b_firmado == 1}">
                                        <options>
                                            <option label="SI" value="1" />
                                            <option label="NO" value="0" />
                                            <option label="N/A" value="2" />
                                        </options>
                                    </radio>
                                </row>
                                <row>
                                    <textarea id="observaciones_cuestionario" label="Observaciones: " value="${entity.d_observaciones}" readonly="${entity.inspeccion.b_firmado == 1}"/>
                                </row>
                            </table>
                            <p value="" />
                        </datalistitem>
                    </datalist>
                </tabitem>
                <tabitem label="PRODUCTO-MARCA">
                    <table border="false">
                        <row colspan="50, 25, 25">
                            <p value=""/>
                            <button label="Todos SI" render="${entity.inspeccion.b_firmado != 1}">
                                <action type="js" controller="datatablePmInspeccion" refresh="datatablePmInspeccion">
                                    <param name="method" value="todosSiInspeccion" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                </action>
                            </button>
                            <button label="Todos NO" render="${entity.inspeccion.b_firmado != 1}">
                                <action type="js" controller="datatablePmInspeccion" refresh="datatablePmInspeccion" >
                                    <param name="method" value="todosNoInspeccion" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                </action>
                            </button>
                        </row>
                    </table>
                    <datatable repo="pmInspeccionRepo" route="idProdMarca-editProdMarca"
                        allowsPartialRestore="false" id="datatablePmInspeccion">
                        <column filtering="true" headerText="Código" id="column_id"
                            ordering="true" value="${entity.c_pm_inspeccion_id}">
                            <filter matching="contains" property="c_pm_inspeccion_id"
                                valueExpression="${this.column_id}" />
                            <order property="c_pm_inspeccion_id" />
                        </column>
                        <column filtering="true" headerText="Producto" id="column_prod"
                            ordering="true" value="${entity.d_producto}">
                            <filter matching="contains" property="d_producto"
                                valueExpression="${this.column_prod}" />
                            <order property="d_producto" />
                        </column>
                        <column filtering="true" headerText="Marca" id="column_marca"
                            ordering="true" value="${entity.d_marca}">
                            <filter matching="contains" property="d_marca"
                                valueExpression="${this.column_marca}" />
                            <order property="d_marca" />
                        </column>
                        <column id="column_b_inspeccionado" filtering="false" ordering="false" headerText="Inspeccionado" value="${entity.b_inspeccionado == 1?'Sí':'No'}"/>
                        <column id="column_b_utilizado" filtering="false" ordering="false" headerText="Utilizado" value="${entity.b_utilizado == 1?'Sí':entity.b_utilizado == 0?'No':entity.b_utilizado == 2?'N/A':''}"/>
                        <column id="column_b_volumen" filtering="false" ordering="false" headerText="Todo Volumen" value="${entity.b_volumen == 1?'Sí':entity.b_volumen == 0?'No':entity.b_volumen == 2?'N/A':''}"/>
                        <column id="column_b_conforme" filtering="false" ordering="false" headerText="Conforme" value="${entity.b_conforme == 1?'Sí':entity.b_conforme == 0?'No':entity.b_conforme == 2?'N/A':''}"/>
                        <column id="column_b_integrado" filtering="false" ordering="false" headerText="Integrado" value="${entity.b_integrado == 1?'Sí':entity.b_integrado == 0?'No':entity.b_integrado == 2?'N/A':''}"/>
                        <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}"/>
                        <param name="b_firmado" value="${entity.b_firmado}" />
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra_id}" />
                            </and>
                        </repofilter>
                    </datatable>

                </tabitem>
                <tabitem label="TRAZABILIDAD">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Trazabilidad:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea lines="20" value="${entity.d_trazabilidad}" readonly="${entity.b_firmado == 1}"/>
                </tabitem>
                <tabitem label="NOTAS">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Notas:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea lines="50" value="${entity.d_anotaciones}" readonly="${entity.b_firmado == 1}"/>
                </tabitem>
                <tabitem label="FIRMA">
                    <table border="false" weights="70, 30">
                        <row>
                            <input label="Lugar: " value="${entity.d_dir_industrial_localidad}" readonly="${entity.b_firmado == 1}" validator="required"/>
                            <date converter="long" pattern="unixepoch_s" label="Fecha inspección: "
                                value="${entity.f_firma}" validator="required" readonly="${entity.b_firmado == 1}"/>
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Técnico 1:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row>
                            <input label="Técnico 1: " id="idTecnico1" value="${entity.d_nombre_inspector1+' '+entity.d_apellidos_inspector1}" validator="required" readonly="true"/>
                        </row>
                    </table>
                    <table border="false" render="${not empty(view.idTecnico1)}">
                        <row weights="50, 50">
                            <image label="Firma ténico 1: " converter="b64Image" embedded="true" value="${entity.firma_t1}" hasDeleteButton="false" inputType="4" validator="required" readonly="${entity.b_firmado == 1}"/>
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_idTecnico1" value="Fdo. ${entity.d_nombre_inspector1+' '+entity.d_apellidos_inspector1}" readonly="true"/>
                        </row>
                    </table>
                    <table border="false" render="${entity.b_firmado != 1 or not empty(view.idTecnico2)}">
                        <row>
                            <divisor color="#00766C" strokeWidth="10" />
                        </row>
                        <row>
                            <p bold="true" fontSize="18" value="Técnico 2:" />
                        </row>
                        <row>
                            <divisor color="#00766C" strokeWidth="10" />
                        </row>
                    </table>
                    <table border="false" render="${entity.b_firmado != 1 or not empty(view.idTecnico3)}">
                        <row>
                            <input label="Técnico 2: " id="idTecnico2"  value="${entity.d_firma_t2}" readonly="${entity.b_firmado == 1}"/>
                        </row>
                    </table>
                    <table border="false" render="${not empty(view.idTecnico2)}">
                        <row weights="50, 50">
                            <image label="Firma ténico 2: " converter="b64Image" embedded="true" value="${entity.firma_t2}" hasDeleteButton="false" inputType="4" readonly="${entity.b_firmado == 1}"/>
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_idTecnico2" value="Fdo. ${entity.d_nombre_inspector2+' '+entity.d_apellidos_inspector2}" readonly="true"/>
                        </row>
                    </table>
                    <table border="false" render="${entity.b_firmado != 1 or not empty(view.idTecnico3)}">
                        <row>
                            <divisor color="#00766C" strokeWidth="10" />
                        </row>
                        <row>
                            <p bold="true" fontSize="18" value="Técnico 3:" />
                        </row>
                        <row>
                            <divisor color="#00766C" strokeWidth="10" />
                        </row>
                    </table>
                    <table border="false" render="${entity.b_firmado != 1 or not empty(view.idTecnico3)}">
                        <row>
                            <input label="Técnico 3: " id="idTecnico3" value="${entity.d_firma_t3}" readonly="${entity.b_firmado == 1}"/>
                        </row>
                    </table>
                    <table border="false" render="${not empty(view.idTecnico3)}">
                        <row weights="50, 50">
                            <image label="Firma ténico 3: " converter="b64Image" embedded="true" value="${entity.firma_t3}" hasDeleteButton="false" inputType="4" readonly="${entity.b_firmado == 1}"/>
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_idTecnico3" value="Fdo. ${entity.d_nombre_inspector3+' '+entity.d_apellidos_inspector3}" readonly="true"/>
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Responsable:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row>
                            <input id="responsable" label="Responsable: " value="${entity.d_repr_nombre_instal+' '+entity.d_repr_apellidos_instal}" readonly="true"/>
                        </row>
                    </table>
                    <table border="false" render="${not empty(view.responsable)}">
                        <row weights="50, 30, 30">
                            <image id="firma_responsable" label="Firma responsable: " converter="b64Image" embedded="true" value="${entity.firma_entidad}" hasDeleteButton="false" inputType="4" readonly="${entity.b_firmado == 1}"/>
                            <radio converter="long" id="b_conforme" label="Conforme: " value="${entity.b_conforme}" orientation="horizontal" readonly="${entity.b_firmado == 1}">
                                <options>
                                    <option label="SI" value="1" />
                                    <option label="NO" value="0" />
                                </options>
                            </radio>
                            <button label="Previsualizar informe">
                                <action id="compositePrevisualizarInfore">
                                    <action
                                        controller="datalistControlDocInspeccionTipo5,datalistControlCuestionario,formInspeccion, datalistRegistrosEmbotelladores, datalistRegistrosSanitarios, datalistFigurasCalidad"
                                        registerInHistory="false" type="save">
                                        <param name="inspeccion" value="${view.inspeccion}" />
                                    </action>
                                    <action type="js">
                                        <param name="method" value="setDFichero" />
                                        <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    </action>
                                    <action registerInHistory="false" type="job">
                                        <param name="jobId" value="job_generar_informe_inspeccion" />
                                        <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                        <param name="c_cuestionario_respondido" value="${entity.c_cuestionario_respondido}" />
                                        <param name="previa" value="SI" />
                                        <param name="d_fichero" value="${entity.d_fichero}" />
                                    </action>
                                </action>
                            </button>
                        </row>
                        <row>
                            <input id="fdo_responsable" value="Fdo. ${entity.d_repr_nombre_instal+' '+entity.d_repr_apellidos_instal}" readonly="true" allowsPartialRestore="false" />
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row>
                            <textarea lines="10" value="${entity.d_obs_suscripcion}" readonly="${entity.b_firmado == 1}"/>
                        </row>
                    </table>
                </tabitem>
            </tab>
        </form>
        <buttonbar type="bottom">
            <button label="Save" readonly="${empty (entity.b_inspeccionado_pm)}" readonlyMessage="Debe inspeccionar todos los productos marca">
                <action
                    controller="datalistControlDocInspeccionTipo5,datalistControlCuestionario,formInspeccion, datalistRegistrosEmbotelladores, datalistRegistrosSanitarios, datalistFigurasCalidad"
                    registerInHistory="false" type="save" route="back">
                    <param name="inspeccion" value="${view.inspeccion}" />
                </action>
            </button>
            <button label="Cancel" route="back" />
        </buttonbar>

    </edit>
</main>