<main name="Inspecciones" id="inspeccion" repo="inspeccionRepo">
    <list name="INSPECCIONES" description="Listado de Inspecciones" id="listInspeccion">
        <datatable route="inspeccion-editInspeccion">
            <column filtering="true" headerText="Identificador" id="column_inspeccion"
                ordering="true" value="${entity.c_accion_singra_id}">
                <filter matching="contains" property="c_accion_singra_id"
                    valueExpression="${this.column_inspeccion}" />
                <order property="c_accion_singra_id" />
            </column>
            <column filtering="true" headerText="Inspección" id="column_c_inspeccion"
                ordering="true" value="${entity.c_inspeccion}">
                <filter matching="contains" property="c_inspeccion"
                    valueExpression="${this.column_c_inspeccion}" />
                <order property="c_inspeccion" />
            </column>
            <column filtering="true" headerText="Usuario" id="column_c_usuario"
                ordering="true" value="${entity.c_usuario}">
                <filter matching="contains" property="c_usuario"
                    valueExpression="${this.column_c_usuario}" />
                <order property="c_usuario" />
            </column>
            <column filtering="true" headerText="Nombre entidad" id="column_nombre_entidad"
                ordering="true" value="${entity.d_nombre_entidad}">
                <filter matching="contains" property="d_nombre_entidad"
                    valueExpression="${this.column_nombre_entidad}" />
                <order property="d_nombre_entidad" />
            </column>
            <column filtering="true" headerText="CIF entidad" id="column_cif_entidad"
                ordering="true" value="${entity.d_cif_entidad}">
                <filter matching="contains" property="d_cif_entidad"
                    valueExpression="${this.column_cif_entidad}" />
                <order property="d_cif_entidad" />
            </column>
            <column id="column_b_cancelada" filtering="false" ordering="false" headerText="Cancelada" value="${entity.b_cancelada == 1?'Sí':'No'}"/>
            <column id="column_b_firmado" filtering="false" ordering="false" headerText="Inspeccionada" value="${entity.b_firmado == 1?'Sí':'No'}"/>
            <column id="column_b_telefonico" filtering="false" ordering="false" headerText="Telefónico" value="${entity.b_telefonico == 1?'Sí':'No'}"/>
        </datatable>
        <buttonbar type="fab" />
    </list>

    <edit id="editInspeccion">
        <script src="scripts/control.js"/>
        <form id="formInspeccion">
            <p value="" />
            <p backgroundColor="#26a69a" bold="true" fontColor="#FFFFFF" fontSize="22"
                value="INSPECCIÓN" />
            <table id="buttonPanel" border="false">
                <row colspan="50, 25, 25">
                    <p value=""/>
                    <!--button label="Generar informe" render="${not empty(view.b_conforme) and not empty(view.firma_responsable)}"-->
                    <button label="Previsualizar informe" render="${entity.b_firmado == 0 and entity.b_cancelada == '0'}" readonly="${empty (entity.b_inspeccionado_pm) || empty (entity.b_inspeccionado_cuestionario)}" readonlyMessage="Debe inspeccionar todos los productos marca y el cuestionario de la inspección" messageType="modal">
                        <action id="compositePrevisualizarInfore">
                            <action
                                controller="datalistControlDocInspeccionTipo5, formInspeccion, datalistRegistrosEmbotelladores, datalistRegistrosSanitarios, datalistFigurasCalidad, datalistTelefonico"
                                registerInHistory="false" type="save">
                                <param name="inspeccion" value="${view.inspeccion}" />
                            </action>
                            <action registerInHistory="false" type="job">
                                <param name="jobId" value="job_generar_informe_inspeccion" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                <param name="c_cuestionario_respondido" value="${entity.c_cuestionario_respondido}" />
                                <param name="previa" value="SI" />
                                <param name="d_fichero" value="${entity.d_fichero_prev}" />
                            </action>
                        </action>
                    </button>
                    <button label="Finalizar inspección" render="${entity.b_firmado != 1 and entity.b_cancelada == '0'}" readonly="${empty (entity.b_inspeccionado_pm) || empty (entity.b_inspeccionado_cuestionario)}" readonlyMessage="Debe inspeccionar todos los productos marca y el cuestionario de la inspección" messageType="modal">
                        <action id="compositeAction3">
                            <action type="js">
                                <param name="method" value="setDFichero" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            </action>
                            <action
                                controller="datalistControlDocInspeccionTipo5, formInspeccion, datalistRegistrosEmbotelladores, datalistRegistrosSanitarios, datalistFigurasCalidad, datalistTelefonico"
                                registerInHistory="false" type="save">
                                <param name="inspeccion" value="${view.inspeccion}" />
                            </action>
                            <action type="js">
                                <param name="method" value="setInspeccionadaInspeccion" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            </action>
                            <action type="nav" route="inspeccion-editInspeccion" registerInHistory="false">
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                <param name="entityId" value="${entity.c_accion_singra_id}" />
                            </action>
                        </action>
                    </button>
                    <button label="Generar informe" render="${entity.b_firmado == 1 and entity.b_cancelada == '0'}">
                        <action registerInHistory="false" type="job">
                                <param name="jobId" value="job_generar_informe_inspeccion" />
                                <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                <param name="c_cuestionario_respondido" value="${entity.c_cuestionario_respondido}" />
                                <param name="previa" value="NO" />
                                <param name="d_fichero" value="${entity.d_fichero}" />
                          </action>
                    </button>
                    <button id="cambiarATelefonico" label="Cambiar a telefónico" confirmation="true" labelConfirmation="Se va a cambiar la inspección a modo telefónico. ¿Desea continuar?"
                        render="${entity.b_firmado != 1 and entity.b_cancelada == '0' and entity.b_telefonico == '0'}">
                        <action type="js" refresh="buttonPanel">
                            <param name="method" value="cambiarInspeccionTelefonica" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                        </action>
                    </button>
                    <button id="cambiarAPresencial" label="Cambiar a presencial" confirmation="true" labelConfirmation="Se va a cambiar la inspección a modo presencial. ¿Desea continuar?"
                        render="${entity.b_firmado != 1 and entity.b_cancelada == '0' and entity.b_telefonico == '1'}">
                        <action type="js" refresh="buttonPanel">
                            <param name="method" value="cambiarInspeccionInsitu" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                        </action>
                    </button>
                    <button label="Cancelar inspección" confirmation="true" labelConfirmation="Se va a cancelar la inspección. ¿Desea continuar?"
                        route="back" render="${entity.b_cancelada == '0'}">
                        <action type="js" route="back" registerInHistory="false">
                            <param name="method" value="cancelarInspeccion" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                        </action>
                    </button>
                    <button label="Activar inspección" confirmation="true" labelConfirmation="Se va a activar la inspección. ¿Desea continuar?"
                        route="back" render="${entity.b_cancelada == '1'}">
                        <action type="js" route="back" registerInHistory="false">
                            <param name="method" value="activarInspeccion" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                        </action>
                    </button>
                </row>
            </table>
            <tab>
                <tabitem label="ENTIDAD">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos básicos de la entidad:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="80, 20">
                            <input label="Entidad: " value="${entity.d_nombre_entidad}" readonly="true"/>
                            <input label="CIF: " value="${entity.d_cif_entidad}" readonly="true"/>
                        </row>
                        <row>
                            <input label="Domicilio: " value="${entity.d_dir_social}" readonly="true"/>
                        </row>
                    </table>
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos del Representante legal:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="40, 40, 20">
                            <input label="Nombre: " value="${entity.d_repr_nombre_entidad}" readonly="true" />
                            <input label="Apellidos: " value="${entity.d_repr_apell_entidad}" readonly="true"/>
                            <input label="NIF: " value="${entity.d_repr_nif_entidad}" readonly="true"/>
                        </row>
                    </table>
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea id="d_obs_entidad" lines="6" value="${entity.d_obs_entidad}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}">
                        <action type="js">
                            <param name="method" value="setObservaciones" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            <param name="d_obs_key" value="d_obs_entidad" />
                            <param name="d_obs_value" value="${view.d_obs_entidad}" />
                        </action>
                    </textarea>
               </tabitem>
                <tabitem label="INSTALACIÓN">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Datos de la instalación:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="80, 20">
                            <input label="Instalación: " value="${entity.d_nombre_instalacion}" readonly="true"/>
                            <input label="CIF: " value="${entity.d_cif_instalacion}" readonly="true"/>
                        </row>
                        <row>
                            <input label="Domicilio: " value="${entity.d_dir_industrial}" readonly="true"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="10"/>
                    <p bold="true" fontSize="18" value="Registros de Empresas y Actividades Alimentarias de CyL (RAAL):"/>
                    <divisor color="#00766C" strokeWidth="10"/>
                    <datalist id="datalistRegistrosSanitarios" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra_id}" />
                                <eq property="c_tipo_doc" value="4" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemRegistrosSanitarios">

                            <table weights="70, 30">
                                <row>
                                    <input id="nombreRegistroSanitario" label="Registro sanitario: " value="${entity.d_nombre}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                    <date id="f_inicio_validez_registro_sanitario" converter="long" pattern="unixepoch_s" label="Fecha inicio: " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                </row>
                            </table>
                        </datalistitem>
                    </datalist>
                    <p value="No existen registros sanitarios" italic="true" onBeforeRender="countRegistrosSanitarios"/>
                    <p value=""/>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Registros embotelladores:" />
                    <divisor color="#00766C" strokeWidth="10"/>
                    <datalist id="datalistRegistrosEmbotelladores" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra_id}" />
                                <eq property="c_tipo_doc" value="10" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemRegistrosEmbotelladores">
                            <table weights="70, 30">
                                <row>
                                    <input id="nombreRegistroEmbotellador" label="Registro embotellador: " value="${entity.d_nombre}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                    <date id="f_inicio_validez_registro_embotellador" converter="long" pattern="unixepoch_s" label="Fecha inicio: " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                </row>
                            </table>
                        </datalistitem>
                    </datalist>
                    <p value="No existen registros embotelladores" italic="true" onBeforeRender="countRegistrosEmbotelladores"/>
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea id="d_obs_instalacion" lines="3" value="${entity.d_obs_instalacion}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}">
                        <action type="js">
                            <param name="method" value="setObservaciones" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            <param name="d_obs_key" value="d_obs_instalacion" />
                            <param name="d_obs_value" value="${view.d_obs_instalacion}" />
                        </action>
                    </textarea>
                </tabitem>
                <tabitem label="EXPEDIENTE">
                    <p value="" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Productos y marca autorizados:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <datalist id="datalistControlDocInspeccionTipo5" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra_id}" />
                                <eq property="c_tipo_doc" value="5" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemProductosYMarcasAutorizados">
                            <table weights="50, 25, 25">
                                <row>
                                    <input label="Marca: " value="${entity.d_nombre}" readonly="true"/>
                                    <date id="f_inicio_validez_producto_y_marca" converter="long" pattern="unixepoch_s" label="Válido desde " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                    <date id="f_fin_validez_producto_y_marca" converter="long" pattern="unixepoch_s" label="hasta el " value="${entity.f_fin_validez}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                </row>
                                <row>
                                    <textarea label="Producto:" value="${entity.d_observaciones}" readonly="true"/>
                                </row>
                            </table>
                            <p value="" />
                        </datalistitem>
                    </datalist>
                    <p value="No existen productos y marcas autorizados" italic="true" onBeforeRender="countProductosYMarcasAutorizados"/>
                    <p value=""/>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Figuras de calidad:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <datalist id="datalistFigurasCalidad" repo="docInspeccionRepo">
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra_id}" />
                                <eq property="c_tipo_doc" value="6" />
                            </and>
                        </repofilter>
                        <datalistitem id="datalistitemFigurasCalidad">
                            <table weights="50, 25, 25">
                                <row>
                                    <input id="nombreFiguracalidad" label="Figura de calidad: " value="${entity.d_nombre}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                    <date id="f_inicio_validez_figura_calidad" converter="long" pattern="unixepoch_s" label="Fecha inicio: " value="${entity.f_inicio_validez}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}" validator="required"/>
                                    <date id="f_fin_validez_figura_calidad" converter="long" pattern="unixepoch_s" label="Fecha fin: " value="${entity.f_fin_validez}" readonly="${entity.inspeccion.b_firmado == 1 || entity.inspeccion.b_cancelada == '1'}"/>
                                </row>
                            </table>
                        </datalistitem>
                    </datalist>
                    <p value="No existen figuras de calidad" italic="true" onBeforeRender="countFigurasDeCalidad"/>
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea id="d_obs_documentos" lines="5" value="${entity.d_obs_documentos}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}">
                        <action type="js">
                            <param name="method" value="setObservaciones" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            <param name="d_obs_key" value="d_obs_documentos" />
                            <param name="d_obs_value" value="${view.d_obs_documentos}" />
                        </action>
                    </textarea>
                </tabitem>
                <tabitem label="CUESTIONARIOS">
                     <table border="false">
                        <row colspan="25, 25, 25, 25">
                            <button label="Cuestionario inspección">
                                <action type="nav" route="idCuestionario-editCuestionario">
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}"/>
                                    <param name="c_inspeccion" value="${entity.c_inspeccion}"/>
                                    <param name="c_cuestionario_respondido" value="${entity.c_cuestionario_respondido}"/>
                                    <param name="b_firmado" value="${entity.b_firmado}" />
                                    <param name="b_cancelada" value="${entity.b_cancelada}" />
                                    <param name="firma_entidad" value="${view.firma_responsable}" />
                                </action>
                            </button>
                            <button label="Todos SI" render="${entity.b_firmado != 1 and entity.b_cancelada == '0'}">
                                <action type="js" controller="datatablePmInspeccion" refresh="datatablePmInspeccion">
                                    <param name="method" value="todosSiInspeccion" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                </action>
                            </button>
                            <p value="" render="${entity.b_firmado == 1 or entity.b_cancelada != '0'}"/>
                            <button label="Todos NO" render="${entity.b_firmado != 1 and entity.b_cancelada == '0'}">
                                <action type="js" controller="datatablePmInspeccion" refresh="datatablePmInspeccion" >
                                    <param name="method" value="todosNoInspeccion" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                </action>
                            </button>
                            <p value="" render="${entity.b_firmado == 1 or entity.b_cancelada != '0'}"/>
                            <button label="Todos N/A" render="${entity.b_firmado != 1 and entity.b_cancelada == '0'}">
                                <action type="js" controller="datatablePmInspeccion" refresh="datatablePmInspeccion">
                                    <param name="method" value="todosNAInspeccion" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                </action>
                            </button>
                            <p value="" render="${entity.b_firmado == 1 or entity.b_cancelada != '0'}"/>
                        </row>
                    </table>

                    <datatable repo="pmInspeccionRepo" route="idProdMarca-editProdMarca"
                        allowsPartialRestore="false" id="datatablePmInspeccion">
                        <column filtering="true" headerText="Código" id="column_id"
                            ordering="true" value="${entity.c_pm_inspeccion_id}">
                            <filter matching="contains" property="c_pm_inspeccion_id"
                                valueExpression="${this.column_id}" />
                            <order property="c_pm_inspeccion_id" />
                        </column>
                        <column filtering="true" headerText="Producto" id="column_prod"
                            ordering="true" value="${entity.d_producto}">
                            <filter matching="contains" property="d_producto"
                                valueExpression="${this.column_prod}" />
                            <order property="d_producto" />
                        </column>
                        <column filtering="true" headerText="Marca" id="column_marca"
                            ordering="true" value="${entity.d_marca}">
                            <filter matching="contains" property="d_marca"
                                valueExpression="${this.column_marca}" />
                            <order property="d_marca" />
                        </column>
                        <column id="column_b_inspeccionado" filtering="false" ordering="false" headerText="Inspeccionado" value="${entity.b_inspeccionado == 1?'Sí':'No'}"/>
                        <column id="column_b_utilizado" filtering="false" ordering="false" headerText="Utilizado" value="${entity.b_utilizado == 1?'Sí':entity.b_utilizado == 0?'No':entity.b_utilizado == 2?'N/A':''}"/>
                        <column id="column_b_volumen" filtering="false" ordering="false" headerText="Todo Volumen" value="${entity.b_volumen == 1?'Sí':entity.b_volumen == 0?'No':entity.b_volumen == 2?'N/A':''}"/>
                        <column id="column_b_conforme" filtering="false" ordering="false" headerText="Conforme" value="${entity.b_conforme == 1?'Sí':entity.b_conforme == 0?'No':entity.b_conforme == 2?'N/A':''}"/>
                        <column id="column_b_integrado" filtering="false" ordering="false" headerText="Integrado" value="${entity.b_integrado == 1?'Sí':entity.b_integrado == 0?'No':entity.b_integrado == 2?'N/A':''}"/>
                        <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}"/>
                        <param name="b_firmado" value="${entity.b_firmado}" />
                        <param name="b_cancelada" value="${entity.b_cancelada}" />
                        <param name="firma_entidad" value="${view.firma_responsable}" />
                        <repofilter>
                            <and>
                                <eq property="c_accion_singra" value="${entity.c_accion_singra_id}" />
                            </and>
                        </repofilter>
                      </datatable>

                </tabitem>
                <tabitem label="TRAZABILIDAD-ANOTACIONES">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Trazabilidad:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea id="d_trazabilidad" lines="10" value="${entity.d_trazabilidad}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}">
                        <action type="js">
                            <param name="method" value="setObservaciones" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            <param name="d_obs_key" value="d_trazabilidad" />
                            <param name="d_obs_value" value="${view.d_trazabilidad}" />
                        </action>
                    </textarea>
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Anotaciones complementarias:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <textarea id="d_anotaciones" lines="10" value="${entity.d_anotaciones}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}">
                        <action type="js">
                            <param name="method" value="setObservaciones" />
                            <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                            <param name="d_obs_key" value="d_anotaciones" />
                            <param name="d_obs_value" value="${view.d_anotaciones}" />
                        </action>
                    </textarea>
                </tabitem>

                <tabitem label="FIRMA">
                    <table border="false" weights="60, 20, 20">
                        <row>
                            <input label="Lugar: " value="${entity.d_dir_industrial_localidad}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                            <date id="f_comunicacion" converter="long" pattern="unixepoch_s" label="Fecha comunicación: "
                                value="${entity.f_comunicacion}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                            <date converter="long" pattern="unixepoch_s" label="Fecha inspección: "
                                value="${entity.f_firma}" validator="required" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Técnico 1:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <table border="false">
                        <row weights="40, 60">
                            <input id="nombre_inspector1" label="Nombre 1: " value="${entity.d_nombre_inspector1}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                            <input id="apellidos_inspector1" label="Apellidos 1: " value="${entity.d_apellidos_inspector1}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                        </row>
                    </table>
                    <table border="false">
                        <row weights="50, 50">
                            <image label="Firma ténico 1: " converter="b64Image" embedded="true" value="${entity.firma_t1}" hasDeleteButton="false" inputType="4" validator="required" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_idTecnico1" value="Fdo. ${view.nombre_inspector1+' '+view.apellidos_inspector1}" readonly="true"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Técnico 2:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <table border="false">
                        <row weights="40, 60">
                            <input id="nombre_inspector2" label="Nombre 2: " value="${entity.d_nombre_inspector2}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                            <input id="apellidos_inspector2" label="Apellidos 2: " value="${entity.d_apellidos_inspector2}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                        </row>
                    </table>
                    <table border="false" render="${not empty(view.nombre_inspector2) or not empty(view.apellidos_inspector2)}">
                        <row weights="50, 50">
                            <image label="Firma ténico 2: " converter="b64Image" embedded="true" value="${entity.firma_t2}" hasDeleteButton="false" inputType="4" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_idTecnico2" value="Fdo. ${view.nombre_inspector2+' '+view.apellidos_inspector2}" readonly="true"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Técnico 3:" />
                    <divisor color="#00766C" strokeWidth="10" />

                    <table border="false">
                        <row weights="40, 60">
                            <input id="nombre_inspector3" label="Nombre 3: " value="${entity.d_nombre_inspector3}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                            <input id="apellidos_inspector3" label="Apellidos 3: " value="${entity.d_apellidos_inspector3}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                        </row>
                    </table>
                    <table border="false" render="${not empty(view.nombre_inspector3) or not empty(view.apellidos_inspector3)}">
                        <row weights="50, 50">
                            <image label="Firma ténico 3: " converter="b64Image" embedded="true" value="${entity.firma_t3}" hasDeleteButton="false" inputType="4" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}"/>
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_idTecnico3" value="Fdo. ${view.nombre_inspector3+' '+view.apellidos_inspector3}" readonly="true"/>
                        </row>
                    </table>

                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Responsable:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row weights="40, 40, 20">
                            <input id="nombre_responsable" label="Nombre: " value="${entity.d_repr_nombre_instal}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                            <input id="apellidos_responsable" label="Apellidos: " value="${entity.d_repr_apellidos_instal}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                            <input id="nif_responsable" label="NIF: " value="${entity.d_repr_nif_instal}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required"/>
                        </row>
                    </table>
                    <table border="false">
                        <row>
                            <datalist id="datalistTelefonico" repo="inspeccionRepo">
                                <repofilter>
                                    <and>
                                        <eq property="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    </and>
                                </repofilter>
                                <datalistitem id="datalistitemTelefonico">
                                    <table border="false">
                                        <row weights="50, 50">
                                            <radio converter="long" id="b_telefonico" label="Telefónico: " value="${entity.b_telefonico}" orientation="horizontal" readonly="${entity.b_telefonico == 1 || entity.b_telefonico == 0}" validator="required">
                                                <options>
                                                    <option label="SI" value="1" />
                                                    <option label="NO" value="0" />
                                                </options>
                                            </radio>
                                            <radio converter="long" id="b_conforme" label="Conforme: " value="${entity.b_conforme}" orientation="horizontal" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" validator="required">
                                                <options>
                                                    <option label="SI" value="1" />
                                                    <option label="NO" value="0" />
                                                </options>
                                            </radio>
                                        </row>
                                    </table>
                                </datalistitem>
                            </datalist>
                        </row>
                        <row weights="50, 50">
                            <image id="firma_responsable" label="Firma responsable: " converter="b64Image" embedded="true" value="${entity.firma_entidad}" render="${entity.b_telefonico == 0}" hasDeleteButton="false" inputType="4" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}" />
                            <p value=""/>
                        </row>
                        <row>
                            <input id="fdo_responsable" value="Fdo. ${view.nombre_responsable+' '+view.apellidos_responsable}" render="${entity.b_telefonico == 0}" readonly="true" allowsPartialRestore="false" />
                        </row>
                    </table>
                    <divisor color="#00766C" strokeWidth="10" />
                    <p bold="true" fontSize="18" value="Observaciones:" />
                    <divisor color="#00766C" strokeWidth="10" />
                    <table border="false">
                        <row>
                            <textarea id="d_obs_suscripcion" lines="10" value="${entity.d_obs_suscripcion}" readonly="${entity.b_firmado == 1 || entity.b_cancelada == '1'}">
                                <action type="js">
                                    <param name="method" value="setObservaciones" />
                                    <param name="c_accion_singra_id" value="${entity.c_accion_singra_id}" />
                                    <param name="d_obs_key" value="d_obs_suscripcion" />
                                    <param name="d_obs_value" value="${view.d_obs_suscripcion}" />
                                </action>
                            </textarea>
                        </row>
                    </table>
                </tabitem>
            </tab>
        </form>
        <buttonbar type="bottom">
            <button label="Save" render="${entity.b_cancelada == '0'}" readonly="${entity.b_cancelada == '0' and (empty (entity.b_inspeccionado_pm) || empty (entity.b_inspeccionado_cuestionario))}" readonlyMessage="Debe inspeccionar todos los productos marca y el cuestionario de la inspección" messageType="modal">
                <action
                    controller="datalistControlDocInspeccionTipo5,formInspeccion, datalistRegistrosEmbotelladores, datalistRegistrosSanitarios, datalistFigurasCalidad, datalistTelefonico"
                    registerInHistory="false" type="save" route="back">
                    <param name="inspeccion" value="${view.inspeccion}" />
                </action>
            </button>

            <!--button label="Save2" render="${entity.b_cancelada == '1'}">
                <action
                    registerInHistory="false" type="nav" route="back" render="${entity.b_cancelada == '1'}">
                </action>
            </button-->
           <button label="Cancel" route="back" />
        </buttonbar>

    </edit>
</main>