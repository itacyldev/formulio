<main id="controlInSitu" name="Control in situ" repo="actasControlRepo">
    <list id="listInSitu" name="CONTROL IN SITU">
        <!--<datatable properties="id, num_expediente, operador.razon_social, fecha "/>-->
        <datatable>
            <column id="column_id" headerText="Id Exp." filtering="true" ordering="true" value="${entity.id}">
                <filter property="id" matching="contains" valueExpression="${this.column_id}"/>
                <order property="id"/>
            </column>
            <column id="column_num_expediente" headerText="Nº Exp." filtering="true" ordering="true" value="${entity.num_expediente}">
                <filter property="num_expediente" matching="contains" valueExpression="${this.column_num_expediente}"/>
                <order property="num_expediente"/>
            </column>
            <column id="column_razon_social" headerText="Razón social" filtering="false" ordering="false" value="${entity.operador.razon_social}"/>
            <column id="column_fecha" headerText="Fecha" filtering="true" ordering="true" value="${entity.fecha}">
                <filter property="fecha" matching="contains" valueExpression="${this.column_fecha}"/>
                <order property="fecha"/>
            </column>
        </datatable>
    </list>
    <edit id="editInSitu">
        <form id="formControlInSitu">

            <p value=""/>
            <p backgroundColor="#26a69a" fontSize="22" fontColor="#FFFFFF" bold="true" value="CONTROL IN SITU"/>
            <p value=""/>

            <tab allowsPartialRestore="true">
                <!--<tabitem id="datosGenerales" label="Datos generales" selected="${params.idTabItem eq 'datosGenerales'? true : false}">-->
                <tabitem id="datosGenerales" label="Datos generales">

                    <input id="expediente_id" label="Id. Expediente: " value="${entity.id}" readonly="true" render="${not empty(entity.id)}"/>

                    <input id="num_expediente" label="Nº Expediente: " value="${entity.num_expediente}" validator="required"/>

                    <date label="Fecha:           " value="${entity.fecha}"  validator="required"/>

                    <select label="Equipo auditor: " value="${entity.equipo_auditor_id}"  >
                        <options>
                            <option value="Teresa Yañez Colomo" label="Teresa Yañez Colomo"/>
                            <option value="Emilio Rodrigo Ramos" label="Emilio Rodrigo Ramos" />
                            <option value="José Ignacio Marqués Rodríguez" label="José Ignacio Marqués Rodríguez" />
                            <option value="Cristina Rebollo Acebes" label="Cristina Rebollo Acebes" />
                            <option value="Inmaculada Sáez González" label="Inmaculada Sáez González" />
                            <option value="Irene Lara Hergueras" label="Irene Lara Hergueras" />
                            <option value="Jesús Durán Martín" label="Jesús Durán Martín" />
                            <option value="Juan Carlos González Ruíz" label="Juan Carlos González Ruíz" />
                            <option value="Mª Montserrat Gil Pérez" label="Mª Montserrat Gil Pérez" />
                            <option value="Manuel Fernández Calderón" label="Manuel Fernández Calderón" />
                            <option value="Maria del Carmen Melendre Frías" label="Maria del Carmen Melendre Frías" />
                            <option value="Marta Martín Álvarez" label="Marta Martín Álvarez" />
                            <option value="Ruth Franco Fernández" label="Ruth Franco Fernández" />
                            <option value="Sátur Jiménez Andrés" label="Sátur Jiménez Andrés" />
                            <option value="Óscar Díez Sánchez" label="Óscar Díez Sánchez" />
                        </options>
                    </select>

                    <textarea label="Otros auditores: " value="${entity.otros_auditores}" />

                    <!--<button label="Añadir operador" route="operador-editOperadores" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un operador. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->

                    <button label="Añadir operador" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un operador. Antes debe guardar el expediente">
                        <action type="save" route="operador-editOperadores">
                            <param name="expediente_id" value="${entity.id}" />
                        </action>
                    </button>

                    <autocomplete id="operador" label="Operador: " forceSelection="true" repo="operadorRepo" value="${entity.operador_id}" validator="required">
                        <options labelExpression="${entity.razon_social}" labelFilteringProperty="razon_social" valueProperty="operador_id" />
                    </autocomplete>

                    <autocomplete id="instalacion" label="Instalación: " forceSelection="true" repo="instalacionRepo" value="${entity.instalacion_id}" validator="required">
                        <options labelExpression="${entity.nombre_instalacion}" labelFilteringProperty="nombre_instalacion" valueProperty="instalacion_id" />
                        <repofilter>
                            <eq property="operador_id" value="${view.operador}" mandatory="true"/>
                            <contains property="nombre_instalacion" value="${this.value}"/>
                        </repofilter>
                    </autocomplete>

                    <textarea label="Notas aclaratorias" value="${entity.notas_aclaratorias_datos_generales}"  />

                    <p value=""/>

                    <table border="false" weights="30, 20, 50">
                        <row>
                            <p bold="true" value="Firma"/>
                            <switcher id="switcherFirmaControlInSitu" value="${not empty(entity.firma)?1:0}"/>
                            <p value=""/>
                        </row>
                    </table>
                    <table border="false" weights="10, 90">
                        <row>
                            <p value=""/>
                            <image converter="b64Image" embedded="true" value="${entity.firma}" render="${view.switcherFirmaControlInSitu eq 'true'}" hasDeleteButton="false" hasGalleryButton="false" hasCameraButton="false"/>
                        </row>
                    </table>

                </tabitem>

                <tabitem label="Instalaciones">

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="1.1 Municipio de la provincia de Burgos"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <textarea label="1.1.1 Evidencias" value="${entity.q1_1_evidencias}" />

                    <textarea label="1.1.2 Notas aclaratorias" value="${entity.q1_1_notas}"  />

                    <radio label="1.1.3 Cumple: " value="${entity.q1_1_cumple_municipio}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="1.2 Certificado de inscripción en la IGP"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <textarea label="1.2.1 Evidencias" value="${entity.q1_2_evidencias}"  />

                    <textarea label="1.2.2 Notas aclaratorias" value="${entity.q1_2_notas}"  />

                    <radio label="1.2.3 Cumple: " value="${entity.q1_2_cumple_certificado}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <p value=""/>
                </tabitem>

                <!--<tabitem id="materiasPrimas" label="Materias primas" selected="${params.idTabItem eq 'materiasPrimas'? true : false}">-->
                <tabitem id="materiasPrimas" label="Materias primas">
                    <p value=""/>
                    <table headerText=" Nº lotes, Lotes a revisar" weights="50, 50">
                        <row>
                            <input id="q2_num_lotes" value="${entity.q2_num_lotes}" hasDeleteButton="false" inputType="4" />
                            <input value="${math:floor(math:sqrt(view.q2_num_lotes))}" hasDeleteButton="false" inputType="4" readonly="true"/>
                        </row>
                    </table>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.1 Cebolla Horcal fresca "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="1" />
                        <param name="nombre_materia_prima" value="Cebolla Horcal fresca" />
                    </button>-->

                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="1" />
                            <param name="nombre_materia_prima" value="Cebolla Horcal fresca" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="1" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="2.1.1 Identificación de los equipos de medida utilizados"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p italic="true" value="2.1.1.1 Báscula"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <autocomplete  label="Identificación del equipo: " forceSelection="true" repo="equipoMedidaRepo" value="${entity.q2_1_1_1_identif_bascula}">
                        <options labelExpression="${entity.equipo+' ('+entity.marca_y_modelo+')'}" labelFilteringProperty="equipo" valueProperty="equipo_medida_id" />
                        <repofilter>
                            <eq property="instalacion_id" value="${view.instalacion}" mandatory="true"/>
                            <contains property="equipo" value="${this.value}"/>
                        </repofilter>
                    </autocomplete>

                    <radio label="Propio/Externo: " value="${entity.q2_1_1_1_propioexterno_bascula}" orientation="horizontal" weights="30, 30">
                        <options>
                            <option value="Propio" label="Propio"/>
                            <option value="Externo" label="Externo" />
                        </options>
                    </radio>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p italic="true" value="2.1.1.2 Calibre"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <input label="Identificación del equipo: " value="${entity.q2_1_1_2_identif_calibre_digital}"/>

                    <radio label="Propio/Externo: " value="${entity.q2_1_1_2_propioexterno_calibre_digital}" orientation="horizontal" weights="30, 30">
                        <options>
                            <option value="Propio" label="Propio"/>
                            <option value="Externo" label="Externo" />
                        </options>
                    </radio>


                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.2 Cebolla Horcal procesada "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="2" />
                        <param name="nombre_materia_prima" value="Cebolla Horcal procesada" />
                    </button>-->

                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="2" />
                            <param name="nombre_materia_prima" value="Cebolla Horcal procesada" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="2" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.3 Arroz (variedad, categoría) "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="3" />
                        <param name="nombre_materia_prima" value="Arroz (variedad, categoría)" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="3" />
                            <param name="nombre_materia_prima" value="Arroz (variedad, categoría)" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="3" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.4 Manteca de Cerdo (Tª almacenamiento) "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="4" />
                        <param name="nombre_materia_prima" value="Manteca de Cerdo (Tª almacenamiento)" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="4" />
                            <param name="nombre_materia_prima" value="Manteca de Cerdo (Tª almacenamiento)" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="4" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.5 Sebo (especie) "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="5" />
                        <param name="nombre_materia_prima" value="Sebo (especie)" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="5" />
                            <param name="nombre_materia_prima" value="Sebo (especie)" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="5" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.6 Sangre (de oveja, vaca o cerdo) "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="6" />
                        <param name="nombre_materia_prima" value="Sangre (de oveja, vaca o cerdo)" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="6" />
                            <param name="nombre_materia_prima" value="Sangre (de oveja, vaca o cerdo)" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="6" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.7 Sal (cloruro sódico)"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="7" />
                        <param name="nombre_materia_prima" value="Sal (cloruro sódico)" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="7" />
                            <param name="nombre_materia_prima" value="Sal (cloruro sódico)" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="7" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.8 Tripas"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="8" />
                        <param name="nombre_materia_prima" value="Tripas" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="8" />
                            <param name="nombre_materia_prima" value="Tripas" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="8" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.9 Especia (Básica): Pimienta Negra"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="lote-editLote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <param name="materia_prima_id" value="9" />
                        <param name="nombre_materia_prima" value="Especia (Básica): Pimienta Negra" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="lote-editLote">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                            <param name="materia_prima_id" value="9" />
                            <param name="nombre_materia_prima" value="Especia (Básica): Pimienta Negra" />
                        </action>
                    </button>

                    <datatable
                        route="lote-editLote"
                        numVisibleRows="2"
                        properties="num_lote, proveedor, notas_aclaratorias"
                        repo="loteRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                        <param name="nombre_materia_prima" value="${entity.materiaPrima.nombre_materia_prima}" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="materia_prima_id" value="9" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="2.10 Especias"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir Lote" route="especia-editEspecia" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->
                    <button label="Añadir Lote" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="especia-editEspecia">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="especia-editEspecia"
                        numVisibleRows="2"
                        repo="loteRepo">
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <or>
                                    <eq property="materia_prima_id" value="10" />
                                    <eq property="materia_prima_id" value="11" />
                                    <eq property="materia_prima_id" value="12" />
                                    <eq property="materia_prima_id" value="13" />
                                    <eq property="materia_prima_id" value="14" />
                                    <eq property="materia_prima_id" value="15" />
                                    <eq property="materia_prima_id" value="16" />
                                    <eq property="materia_prima_id" value="17" />
                                    <eq property="materia_prima_id" value="18" />
                                    <eq property="materia_prima_id" value="19" />
                                </or>
                            </and>
                        </repofilter>
                        <column id="column_nombre_materia_prima" headerText="Materia prima" filtering="false" ordering="false" value="${entity.materiaPrima.nombre_materia_prima}"/>
                        <column id="column_num_lote_especia" headerText="Nº Lote" filtering="true" ordering="true" value="${entity.num_lote}">
                            <filter property="num_lote" matching="contains" valueExpression="${this.column_num_lote_especia}"/>
                            <order property="num_lote"/>
                        </column>
                        <column id="column_proveedor" headerText="Proveedor" filtering="true" ordering="true" value="${entity.proveedor}">
                            <filter property="proveedor" matching="contains" valueExpression="${this.column_proveedor}"/>
                            <order property="proveedor"/>
                        </column>
                        <column id="column_notas_aclaratorias" headerText="Notas aclaratorias" filtering="true" ordering="true" value="${entity.notas_aclaratorias}">
                            <filter property="notas_aclaratorias" matching="contains" valueExpression="${this.column_notas_aclaratorias}"/>
                            <order property="notas_aclaratorias"/>
                        </column>
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="materiasPrimas" />-->
                        <param name="materia_prima_id" value="${entity.materiaPrima.materia_prima_id}" />
                    </datatable>

                    <radio label="Cumple: " value="${entity.q2_cumple_materias_primas}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                </tabitem>

                <!--<tabitem id="procesoFabricacion" label="Proceso de fabricación 'In situ'" selected="${params.idTabItem eq 'procesoFabricacion'? true : false}">-->
                <tabitem id="procesoFabricacion" label="Proceso de fabricación 'In situ'">
                    <p value=""/>
                    <table headerText=" Nº lote, F. fabricación" weights="60, 40">
                        <row>
                            <input value="${entity.q3_num_lote}" hasDeleteButton="false"/>
                            <date value="${entity.q3_fecha_fabricacion}" hasDeleteButton="false" hasTodayButton="false" />
                        </row>
                    </table>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1 % DE INGREDIENTES EN LA ELABORACIÓN"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="Comprobación de ingredientes"/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value=""/>

                    <table headerText=" Peso, %">
                        <row colspan="2">
                            <p value="3.1.1 Cebolla Horcal (Mayor del 35%)"/>
                        </row>
                        <row>
                            <input id="q3_1_1_cebolla_peso" value="${entity.q3_1_1_cebolla_peso}" hasDeleteButton="false" inputType="3"/>
                            <input value="${view.q3_1_1_cebolla_peso gt 0? math:round(view.q3_1_1_cebolla_peso*100*math:pow(10,2)/view.total_peso)/math:pow(10,2):null}" readonly="true" inputType="3"/>
                        </row>
                        <row colspan="2">
                            <p value="3.1.2 Arroz (Del 15% al 30%)"/>
                        </row>
                        <row>
                            <input id="q3_1_2_arroz_peso" value="${entity.q3_1_2_arroz_peso}" hasDeleteButton="false" inputType="3"/>
                            <input value="${view.q3_1_2_arroz_peso gt 0? math:round(view.q3_1_2_arroz_peso*100*math:pow(10,2)/view.total_peso)/math:pow(10,2):null}" readonly="true" inputType="3"/>
                        </row>
                        <row colspan="2">
                            <p value="3.1.3 Sangre (Mayor del 12%)"/>
                        </row>
                        <row>
                            <input id="q3_1_3_sangre_peso" value="${entity.q3_1_3_sangre_peso}" hasDeleteButton="false" inputType="3"/>
                            <input value="${view.q3_1_3_sangre_peso gt 0? math:round(view.q3_1_3_sangre_peso*100*math:pow(10,2)/view.total_peso)/math:pow(10,2):null}" readonly="true" inputType="3"/>
                        </row>
                        <row colspan="2">
                            <p value="3.1.4 Manteca de Cerdo o sebo (Del 10% al 22%)"/>
                        </row>
                        <row>
                            <input id="q3_1_4_manteca_peso" value="${entity.q3_1_4_manteca_peso}" hasDeleteButton="false" inputType="3"/>
                            <input value="${view.q3_1_4_manteca_peso gt 0? math:round(view.q3_1_4_manteca_peso*100*math:pow(10,2)/view.total_peso)/math:pow(10,2):null}" readonly="true" inputType="3"/>
                        </row>
                        <row colspan="2">
                            <p value="3.1.5 Sal"/>
                        </row>
                        <row colspan="2">
                            <input id="q3_1_5_sal_peso" value="${entity.q3_1_5_sal_peso}" hasDeleteButton="false" inputType="3"/>
                        </row>
                        <row colspan="2">
                            <p value="3.1.6 Especias"/>
                        </row>
                        <row colspan="2">
                            <input id="q3_1_6_especias_peso" value="${entity.q3_1_6_especias_peso}" hasDeleteButton="false" inputType="3"/>
                        </row>
                        <row colspan="2">
                            <p value="TOTAL"/>
                        </row>
                        <row colspan="2">
                            <input id="total_peso" value="${(view.q3_1_1_cebolla_peso + view.q3_1_2_arroz_peso + view.q3_1_3_sangre_peso + view.q3_1_4_manteca_peso + view.q3_1_5_sal_peso + view.q3_1_6_especias_peso) gt 0? math:round((view.q3_1_1_cebolla_peso + view.q3_1_2_arroz_peso + view.q3_1_3_sangre_peso + view.q3_1_4_manteca_peso + view.q3_1_5_sal_peso + view.q3_1_6_especias_peso)*math:pow(10,2))/math:pow(10,2):null}" hasDeleteButton="false" inputType="3" readonly="true"/>
                        </row>
                    </table>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1.1 Cebolla Horcal (Mayor del 35%)"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <radio label="Cumple: " value="${entity.q3_1_1_cebolla_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <textarea label="Notas aclaratorias" value="${entity.q3_1_1_cebolla_notas}" hasDeleteButton="false"/>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1.2 Arroz (Del 15% al 30%)"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <radio label="Cumple: " value="${entity.q3_1_2_arroz_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias" value="${entity.q3_1_2_arroz_notas}" hasDeleteButton="false"/>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1.3 Sangre (Mayor del 12%)"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <radio label="Cumple: " value="${entity.q3_1_3_sangre_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias" value="${entity.q3_1_3_sangre_notas}" hasDeleteButton="false"/>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1.4 Manteca de Cerdo o sebo (Del 10% al 22%)"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <radio label="Cumple: " value="${entity.q3_1_4_manteca_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias" value="${entity.q3_1_4_manteca_notas}" hasDeleteButton="false"/>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1.5 Sal"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <radio label="Cumple: " value="${entity.q3_1_5_sal_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias" value="${entity.q3_1_5_sal_notas}" hasDeleteButton="false"/>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.1.6 Especias"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <radio label="Cumple: " value="${entity.q3_1_6_especias_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias" value="${entity.q3_1_6_especias_notas}" hasDeleteButton="false"/>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="3.2 PROCESO DE ELABORACIÓN "/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.1 Preparación y pesado de las materias primas"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.1.1 Las materias primas se pesan y se anotan"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias:" value="${entity.q3_2_1_1_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_1_1_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.1.2 El arroz se pesa en seco"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias:" value="${entity.q3_2_1_2_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_1_2_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.1.3 Precocción del arroz antes de 48h."/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias:" value="${entity.q3_2_1_3_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_1_3_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.1.4 Acondicionado de la tripa"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias:" value="${entity.q3_2_1_4_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_1_4_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.1.5 Notas aclaratorias"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea value="${entity.q3_2_1_5_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.2 Picado de la manteca de cerdo o sebo"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.2.1 La manteca de cerdo o sebo se pica"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_2_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_2_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_2_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.3 Picado de la cebolla"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.3.1 La cebolla se pica"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_3_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_3_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_3_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.4 Sofrito opcional de la cebolla con toda o parte de la manteca de cerdo"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.4.1 Se sofrie la cebolla con la manteca de cerdo"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_4_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_4_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_4_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.5 Amasado de las materias primas"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.5.1 Se amasan todas las materias primas formando una masa homogenea"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_5_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_5_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_5_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.6 Embutido de la masa"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.6.1 Se introduce la masa en la tripa"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_6_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_6_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_6_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.7 Delimitación de las piezas de morcilla"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.7.1 Atado o grapado"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_7_1_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_7_1_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.7.2 Corte en piezas"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_7_2_evidencias}" />
                    <radio label="Cumple corte en piezas: " value="${entity.q3_2_7_2_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>

                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.7.3 Notas aclaratorias"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea value="${entity.q3_2_7_3_notas}" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.8 Cocción de las morcillas"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.8.1 Temperatura mayor de 90º C"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_8_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_8_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_8_notas}" hasDeleteButton="false" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p value="3.2.9 Oreo"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="4" />
                    <p italic="true" value="3.2.9.1 Tiempo de oreo"/>
                    <divisor color="#00766C" strokeWidth="4" />

                    <textarea label="Evidencias: " value="${entity.q3_2_9_evidencias}" />
                    <radio label="Cumple: " value="${entity.q3_2_9_cumple}" orientation="horizontal" weights="15, 85">
                        <options>
                            <option label="Sí" value="S" />
                            <option label="No" value="N" />
                        </options>
                    </radio>
                    <textarea label="Notas aclaratorias: " value="${entity.q3_2_9_notas}" hasDeleteButton="false" />
                </tabitem>

                <!--<tabitem id="productoTerminado" label="Producto terminado" selected="${params.idTabItem eq 'productoTerminado'? true : false}">-->
                <tabitem id="productoTerminado" label="Producto terminado">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="4.1 PRODUCTO TERMINADO"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="productoTerminado-editProductoTerminado" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->

                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="productoTerminado-editProductoTerminado">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="productoTerminado-editProductoTerminado"
                        numVisibleRows="3"
                        properties="num_lote, presentacion, ingredientes, cumple_producto_terminado, notas_aclaratorias"
                        repo="productoTerminadoRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="productoTerminado" />-->
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="4.2 RELACION DE PESOS DE MORCILLA POR TIPOS"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="tipoMorcilla-editTipoMorcilla" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un tipo de morcilla. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->

                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un tipo de morcilla. Antes debe guardar el expediente">
                        <action type="save" route="tipoMorcilla-editTipoMorcilla">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador_id" value="${entity.operador_id}" />
                            <param name="razon_social" value="${entity.operador.razon_social}" />
                            <param name="instalacion_id" value="${entity.instalacion_id}" />
                            <param name="nombre_instalacion" value="${entity.instalacion.nombre_instalacion}" />
                            <param name="desde" value="Control In Situ" />
                        </action>
                    </button>

                    <datatable
                        route="tipoMorcilla-editTipoMorcilla"
                        numVisibleRows="3"
                        repo="tipoMorcillaRepo">
                        <column id="column_tipo_morcilla" headerText="Tipo morcilla" filtering="true" ordering="true" value="${entity.tipo_morcilla}">
                            <filter property="tipo_morcilla" matching="contains" valueExpression="${this.column_tipo_morcilla}"/>
                            <order property="tipo_morcilla"/>
                        </column>
                        <column id="column_peso_unitario_kg" headerText="Peso unitario Kg" filtering="true" ordering="true" value="${entity.peso_unitario_kg}">
                            <filter property="peso_unitario_kg" matching="contains" valueExpression="${this.column_peso_unitario_kg}"/>
                            <order property="peso_unitario_kg"/>
                        </column>
                        <column id="column_unidad_kg" headerText="Unidades teóricas/kg" filtering="true" ordering="true" value="${entity.peso_unitario_kg gt 0? math:round(math:pow(10,2)/entity.peso_unitario_kg)/math:pow(10,2):null}">
                            <filter property="unidad_kg" matching="contains" valueExpression="${this.column_unidad_kg}"/>
                            <order property="unidad_kg"/>
                        </column>
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador_id" value="${entity.expediente.operador.operador_id}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="instalacion_id" value="${entity.expediente.instalacioninstalacion_id}" />
                        <param name="nombre_instalacion" value="${entity.expediente.instalacion.nombre_instalacion}" />
                        <param name="desde" value="Control In Situ" />

                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <or>
                                    <eq property="control_in_situ" value="S"/>
                                </or>
                            </and>
                        </repofilter>
                    </datatable>
                </tabitem>

                <!--<tabitem id="productoTransformado" label="Producto transformado" selected="${params.idTabItem eq 'productoTransformado'? true : false}">-->
                <tabitem id="productoTransformado" label="Producto transformado">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="5. PRODUCTO TRANSFORMADO"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="prodTransformado-editProdTransformado" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->

                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="prodTransformado-editProdTransformado">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="prodTransformado-editProdTransformado"
                        numVisibleRows="3"
                        properties="num_lote, presentacion, ingredientes, cumple_producto_transformado, notas_aclaratorias"
                        repo="productoTransformadoRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="productoTransformado" />-->
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                            </and>
                        </repofilter>
                    </datatable>

                </tabitem>

                <!--<tabitem id="productoEtiquetado" label="Etiquetado" selected="${params.idTabItem eq 'productoEtiquetado'? true : false}">-->
                <tabitem id="productoEtiquetado" label="Etiquetado">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="6. PRODUCTO ETIQUETADO"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="productoEtiquetado-editProductoEtiquetado" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador_id" value="${entity.operador_id}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->

                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="productoEtiquetado-editProductoEtiquetado">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador_id" value="${entity.operador_id}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable id="datatableProductoEtiquetado"
                        route="productoEtiquetado-editProductoEtiquetado"
                        numVisibleRows="3"
                        repo="productoEtiquetadoRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador_id" value="${entity.expediente.operador.operador_id}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                            </and>
                        </repofilter>
                        <column id="column_num_lote_etiquetado" headerText="Nº Lote" filtering="true" ordering="true" value="${entity.num_lote}">
                            <filter property="num_lote" matching="contains" valueExpression="${this.column_num_lote_etiquetado}"/>
                            <order property="num_lote"/>
                        </column>
                        <column id="column_nombre_marca_producto_etiquetado" headerText="Marca" filtering="false" ordering="false" value="${entity.marca.nombre_marca}"/>
                        <column id="column_presentacion" headerText="Presentación" filtering="true" ordering="true" value="${entity.presentacion}">
                            <filter property="presentacion" matching="contains" valueExpression="${this.column_presentacion}"/>
                            <order property="presentacion"/>
                        </column>
                        <column id="column_ingredientes" headerText="Ingredientes" filtering="true" ordering="true" value="${entity.ingredientes}">
                            <filter property="ingredientes" matching="contains" valueExpression="${this.column_ingredientes}"/>
                            <order property="ingredientes"/>
                        </column>
                        <column id="column_notas_aclaratorias_material_etiquetado" headerText="Notas aclaratorias material etiquetado" filtering="true" ordering="true" value="${entity.notas_aclaratorias_material_etiquetado}">
                            <filter property="notas_aclaratorias_material_etiquetado" matching="contains" valueExpression="${this.column_notas_aclaratorias_material_etiquetado}"/>
                            <order property="notas_aclaratorias_material_etiquetado"/>
                        </column>
                        <column id="column_cumple_material_etiquetado" headerText="Cumple material etiquetado" filtering="true" ordering="true" value="${entity.cumple_material_etiquetado}">
                            <filter property="cumple_material_etiquetado" matching="contains" valueExpression="${this.column_cumple_material_etiquetado}"/>
                            <order property="cumple_material_etiquetado"/>
                        </column>
                        <column id="column_notas_aclaratorias_valor_nutricional" headerText="Notas aclaratorias valor nutricional" filtering="true" ordering="true" value="${entity.notas_aclaratorias_valor_nutricional}">
                            <filter property="notas_aclaratorias_valor_nutricional" matching="contains" valueExpression="${this.column_notas_aclaratorias_valor_nutricional}"/>
                            <order property="notas_aclaratorias_valor_nutricional"/>
                        </column>
                        <column id="column_cumple_valor_nutricional" headerText="Cumple valor nutricional" filtering="true" ordering="true" value="${entity.cumple_valor_nutricional}">
                            <filter property="cumple_valor_nutricional" matching="contains" valueExpression="${this.column_cumple_valor_nutricional}"/>
                            <order property="cumple_valor_nutricional"/>
                        </column>
                        <column id="column_peso1" headerText="Peso 1" filtering="true" ordering="true" value="${entity.peso1}">
                            <filter property="peso1" matching="contains" valueExpression="${this.column_peso1}"/>
                            <order property="peso1"/>
                        </column>
                        <column id="column_peso2" headerText="Peso 2" filtering="true" ordering="true" value="${entity.peso2}">
                            <filter property="peso2" matching="contains" valueExpression="${this.column_peso2}"/>
                            <order property="peso2"/>
                        </column>
                        <column id="column_peso3" headerText="Peso 3" filtering="true" ordering="true" value="${entity.peso3}">
                            <filter property="peso3" matching="contains" valueExpression="${this.column_peso3}"/>
                            <order property="peso3"/>
                        </column>
                        <column id="column_cumple_producto_etiquetado" headerText="Cumple producto etiquetado" filtering="true" ordering="true" value="${entity.cumple_producto_etiquetado}">
                            <filter property="cumple_producto_etiquetado" matching="contains" valueExpression="${this.column_cumple_producto_etiquetado}"/>
                            <order property="cumple_producto_etiquetado"/>
                        </column>
                        <column id="column_notas_aclaratorias_producto_etiquetado" headerText="Notas aclaratorias" filtering="true" ordering="true" value="${entity.notas_aclaratorias}">
                            <filter property="notas_aclaratorias" matching="contains" valueExpression="${this.column_notas_aclaratorias_producto_etiquetado}"/>
                            <order property="notas_aclaratorias"/>
                        </column>
                    </datatable>
                </tabitem>

                <!--<tabitem id="existenciaEtiquetado" label="Existencia etiquetado" selected="${params.idTabItem eq 'existenciaEtiquetado'? true : false}">-->
                <tabitem id="existenciaEtiquetado" label="Existencia etiquetado">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="7. EXISTENCIA ETIQUETADO"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="existenciaEtiquetado-editExistenciaEtiquetado" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir una existencia de material etiquetado. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador_id" value="${entity.operador_id}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->
                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir una existencia de material etiquetado. Antes debe guardar el expediente">
                        <action type="save" route="existenciaEtiquetado-editExistenciaEtiquetado">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador_id" value="${entity.operador_id}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="existenciaEtiquetado-editExistenciaEtiquetado"
                        numVisibleRows="3"
                        repo="existenciaEtiquetadoRepo">
                        <column id="column_tipo" headerText="Tipo" filtering="true" ordering="true" value="${entity.tipo}">
                            <filter property="tipo" matching="contains" valueExpression="${this.column_tipo}"/>
                            <order property="tipo"/>
                        </column>
                        <column id="column_nombre_marca" headerText="Marca" filtering="false" ordering="false" value="${entity.marca.nombre_marca}"/>
                        <column id="column_desde" headerText="Desde" filtering="true" ordering="true" value="${entity.desde}">
                            <filter property="desde" matching="contains" valueExpression="${this.column_desde}"/>
                            <order property="desde"/>
                        </column>
                        <column id="column_hasta" headerText="Hasta" filtering="true" ordering="true" value="${entity.hasta}">
                            <filter property="hasta" matching="contains" valueExpression="${this.column_hasta}"/>
                            <order property="hasta"/>
                        </column>
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador_id" value="${entity.expediente.operador.operador_id}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="existenciaEtiquetado" />-->
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                            </and>
                        </repofilter>
                    </datatable>
                </tabitem>

                <!--<tabitem id="equipoMedida" label="Equipos de medida" selected="${params.idTabItem eq 'equipoMedida'? true : false}">-->
                <tabitem id="equipoMedida" label="Equipos de medida">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="8.1 VERIFICACIÓN EQUIPOS DE MEDIDA"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="verifEquipoMedida-editVerifEquiposMedida" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir una verificación de equipo de medida. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador_id" value="${entity.operador_id}" />
                        <param name="razon_social" value="${entity.operador.razon_social}" />
                        <param name="instalacion_id" value="${entity.instalacion_id}" />
                        <param name="nombre_instalacion" value="${entity.instalacion.nombre_instalacion}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->
                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir una verificación de equipo de medida. Antes debe guardar el expediente">
                        <action type="save" route="verifEquipoMedida-editVerifEquiposMedida">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador_id" value="${entity.operador_id}" />
                            <param name="razon_social" value="${entity.operador.razon_social}" />
                            <param name="instalacion_id" value="${entity.instalacion_id}" />
                            <param name="nombre_instalacion" value="${entity.instalacion.nombre_instalacion}" />
                        </action>
                    </button>

                    <datatable
                        route="verifEquipoMedida-editVerifEquiposMedida"
                        numVisibleRows="3"
                        repo="verificacionEquipoMedidaRepo">
                        <column id="column_equipo" headerText="Equipo" filtering="false" ordering="false" value="${entity.equipoMedida.equipo}"/>
                        <column id="column_nombre_instalacion" headerText="Instalación" filtering="false" ordering="false" value="${entity.equipoMedida.instalacion.nombre_instalacion}"/>
                        <column id="column_marca_y_modelo" headerText="Marca y modelo" filtering="false" ordering="false" value="${entity.equipoMedida.marca_y_modelo}"/>
                        <column id="column_fecha_verif_equipo_medida" headerText="Fecha" filtering="true" ordering="true" value="${entity.fecha}">
                            <filter property="fecha" matching="contains" valueExpression="${this.column_fecha_verif_equipo_medida}"/>
                            <order property="fecha"/>
                        </column>
                        <column id="column_cumple_equipo_medida" headerText="Cumple equipo medida" filtering="true" ordering="true" value="${entity.cumple_equipo_medida}">
                            <filter property="cumple_equipo_medida" matching="contains" valueExpression="${this.column_cumple_equipo_medida}"/>
                            <order property="cumple_equipo_medida"/>
                        </column>
                        <column id="column_notas_aclaratorias_verif_equipo_medida" headerText="Notas aclaratorias" filtering="true" ordering="true" value="${entity.notas_aclaratorias}">
                            <filter property="notas_aclaratorias" matching="contains" valueExpression="${this.column_notas_aclaratorias_verif_equipo_medida}"/>
                            <order property="notas_aclaratorias"/>
                        </column>
                        <param name="expediente_id" value="${entity.expediente.id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador_id" value="${entity.equipoMedida.instalacion.operador.operador_id}" />
                        <param name="razon_social" value="${entity.equipoMedida.instalacion.operador.razon_social}" />
                        <param name="instalacion_id" value="${entity.equipoMedida.instalacion.instalacion_id}" />
                        <param name="nombre_instalacion" value="${entity.equipoMedida.instalacion.nombre_instalacion}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="equipoMedida" />-->
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                                <eq property="instalacion_id" value="${empty(view.instalacion) ? '-1' : view.instalacion}" />
                            </and>
                        </repofilter>
                    </datatable>

                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="8.2 EQUIPOS DE MEDIDA DE LA INSTALACIÓN"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="Añadir equipo" route="equipoMedida-editEquiposMedida" rreadonly="${empty (entity.id)}" readonlyMessage="No puede añadir un equipo de medida. Antes debe guardar el expediente">
                        <param name="instalacion_id" value="${entity.equipoMedida.instalacion.instalacion_id}" />
                        <param name="nombre_instalacion" value="${entity.equipoMedida.instalacion.nombre_instalacion}" />
                        <param name="operador_id" value="${entity.equipoMedida.instalacion.operador.operador_id}" />
                        <param name="razon_social" value="${entity.equipoMedida.instalacion.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->

                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un equipo de medida. Antes debe guardar el expediente">
                        <action type="save" route="equipoMedida-editEquiposMedida">
                            <param name="instalacion_id" value="${entity.equipoMedida.instalacion.instalacion_id}" />
                            <param name="nombre_instalacion" value="${entity.equipoMedida.instalacion.nombre_instalacion}" />
                            <param name="operador_id" value="${entity.equipoMedida.instalacion.operador.operador_id}" />
                            <param name="razon_social" value="${entity.equipoMedida.instalacion.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="equipoMedida-editEquiposMedida"
                        numVisibleRows="3"
                        repo="equipoMedidaRepo">
                        <column id="column_equipo_medida_equipo" headerText="Equipo" filtering="true" ordering="true" value="${entity.equipo}">
                            <filter property="equipo" matching="contains" valueExpression="${this.column_equipo_medida_equipo}"/>
                            <order property="equipo"/>
                        </column>

                        <column id="column_equipo_medida_nombre_instalacion" headerText="Instalación" filtering="false" ordering="false" value="${entity.instalacion.nombre_instalacion}"/>

                        <column id="column_equipo_medida_marca_y_modelo" headerText="Marca y modelo" filtering="true" ordering="true" value="${entity.marca_y_modelo}">
                            <filter property="marca_y_modelo" matching="contains" valueExpression="${this.column_equipo_medida_marca_y_modelo}"/>
                            <order property="marca_y_modelo"/>
                        </column>
                        <param name="expediente_id" value="${entity.expediente.id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador_id" value="${entity.equipoMedida.instalacion.operador.operador_id}" />
                        <param name="razon_social" value="${entity.equipoMedida.instalacion.operador.razon_social}" />
                        <param name="instalacion_id" value="${entity.equipoMedida.instalacion.instalacion_id}" />
                        <param name="nombre_instalacion" value="${entity.equipoMedida.instalacion.nombre_instalacion}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="equipoMedida" />-->
                        <repofilter>
                            <and>
                                <eq property="instalacion_id" value="${empty(entity.instalacion_id) ? '-1' : entity.instalacion_id}" />
                            </and>
                        </repofilter>
                    </datatable>

                </tabitem>

                <!--<tabitem id="productoNoConforme" label="Producto no conforme" selected="${params.idTabItem eq 'productoNoConforme'? true : false}">-->
                <tabitem id="productoNoConforme" label="Producto no conforme">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="9. PRODUCTO NO CONFORME"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="productoNoConforme-editProductoNoConforme" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->
                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir un lote. Antes debe guardar el expediente">
                        <action type="save" route="productoNoConforme-editProductoNoConforme">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="productoNoConforme-editProductoNoConforme"
                        numVisibleRows="3"
                        properties="num_lote, fecha_elaboracion, sistema_identificacion_segregacion, cumple_producto_no_conforme, notas_aclaratorias"
                        repo="productoNoConformeRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="productoNoConforme" />-->
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                            </and>
                        </repofilter>
                    </datatable>
                </tabitem>

                <!--<tabitem id="desviacion" label="Verificación de la implantación de las acciones correctivas" selected="${params.idTabItem eq 'desviacion'? true : false}">-->
                <tabitem id="desviacion" label="Verificación de la implantación de las acciones correctivas">
                    <p value=""/>
                    <divisor color="#00766C" strokeWidth="8" />
                    <p bold="true" value="10. DESVIACIONES"/>
                    <divisor color="#00766C" strokeWidth="8" />

                    <!--<button label="ADD" route="desviacion-editDesviacion" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir una desviación. Antes debe guardar el expediente">
                        <param name="expediente_id" value="${entity.id}" />
                        <param name="num_expediente" value="${entity.num_expediente}" />
                        <param name="operador" value="${entity.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                    </button>-->
                    <button label="Añadir" readonly="${empty (entity.id)}" readonlyMessage="No puede añadir una desviación. Antes debe guardar el expediente">
                        <action type="save" route="desviacion-editDesviacion">
                            <param name="expediente_id" value="${entity.id}" />
                            <param name="num_expediente" value="${entity.num_expediente}" />
                            <param name="operador" value="${entity.operador.razon_social}" />
                        </action>
                    </button>

                    <datatable
                        route="desviacion-editDesviacion"
                        numVisibleRows="3"
                        properties="desviacion, comprobacion_implantacion,solucionado, notas_aclaratorias"
                        repo="desviacionRepo">
                        <param name="expediente_id" value="${entity.expediente_id}" />
                        <param name="num_expediente" value="${entity.expediente.num_expediente}" />
                        <param name="operador" value="${entity.expediente.operador.razon_social}" />
                        <param name="backRoute" value="controlInSitu-editInSitu" />
                        <!--<param name="idTabItem" value="desviacion" />-->
                        <repofilter>
                            <and>
                                <eq property="expediente_id" value="${empty(entity.id) ? '-1' : entity.id}" />
                            </and>
                        </repofilter>
                    </datatable>

                </tabitem>
            </tab>
        </form>
        <!--<actions>
            <save label="Save" route="controlInSitu-listInSitu" registerInHistory="false" controller="formControlInSitu"/>
            <cancel label="Cancel" route="controlInSitu-listInSitu"/>
        </actions>-->

        <buttonbar type="bottom">
            <button label="Save">
                <action type="save" route="back" registerInHistory="false" restoreView="true">
                    <param name="entityId" value="${params.expediente_id}" />
                </action>
            </button>
            <button label="Cancel">
                <action type="cancel" route="back"/>
            </button>
        </buttonbar>
    </edit>
</main>
