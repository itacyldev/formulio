CREATE TABLE "grupo_producto" (
	"grupo_producto_id" TEXT PRIMARY KEY,
	"nombre_grupo_producto"	TEXT
)

insert into "grupo_producto"
(
	grupo_producto_id, 
	nombre_grupo_producto
)
values
	("1", "ACEITES Y GRASAS (Clase 1.5)"),
	("2", "CERVEZAS (Clase 2.1, 2.22)"),
	("3", "CARNES Y DERIVADOS CÁRNICOS. (Clases 1.1 y 1.2)"),
	("4", "CONDIMENTOS Y ESPECIAS (Clase 1.8)"),
	("5", "LECHE Y DERIVADOS LÁCTEOS (Clases 1.3 y 1.4"),
	("6", "PRODUCTOS DE LA APICULTURA (Clase 1.4)"),
	("7", "PRODUCTOS DE PANADERÍA, PASTELERÍA Y REPOSTERÍA (Clase 2.3, 2.5, 2.24, 2.26 y 2.2)"),
	("8", "PRODUCTOS DE LA PESCA Y LA ACUICULTURA (Clase 1.7)"),
	("9", "PRODUCTOS DE ORIGEN VEGETAL SIN TRANSFORMAR Y TRANSFORMADOS (Clase 1.6)"),
	("10", "SALES, EDULCORANTES Y VINAGRES (Clase 1.8, 2.6)")

	
CREATE TABLE "auditoria" (
	"auditoria_id"	INTEGER PRIMARY KEY AUTOINCREMENT,
	"num_expediente" INTEGER,
	"fecha"	TEXT,
	"grupo_producto_id" TEXT,
	"equipo_auditor" TEXT,
	"equipo_medida" TEXT,
	"nombre_establecimiento" TEXT,
	"nif" TEXT,
	"nombre_comercial" TEXT,
	"domicilio_establecimiento" TEXT,
	"prov_id" INTEGER,
	"provmuni_id" TEXT,
	"telefono" TEXT,
	"email" TEXT,
	"tipo_figura_calidad" TEXT,
	"nombre_producto" TEXT,
	"operador" TEXT,
	"domicilio_producto" TEXT,
	"marca_comercial" TEXT,
	"lote" TEXT,
	"codigo_barras" TEXT,
	"codigo_barras_thumb" TEXT,
	"modo_presentacion" TEXT,
	"firma" TEXT,
	FOREIGN KEY(grupo_producto_id) REFERENCES grupo_producto(grupo_producto_id),
	FOREIGN KEY(prov_id) REFERENCES provincia(id),
	FOREIGN KEY(provmuni_id) REFERENCES municipio(provmuni))

CREATE TABLE "pregunta_auditoria" (
	"pregunta_auditoria_id"	INTEGER PRIMARY KEY AUTOINCREMENT,
	"auditoria_id" INTEGER,
	"pregunta_id" INTEGER,
	"tab_id" TEXT,
	"respuesta" TEXT,
	"observaciones" TEXT,
	"image_thumb" TEXT,
	FOREIGN KEY(auditoria_id) REFERENCES auditoria(auditoria_id),
	FOREIGN KEY(pregunta_id) REFERENCES pregunta(pregunta_id)
)

CREATE TRIGGER pregunta_auditoria AFTER INSERT ON auditoria
BEGIN
	INSERT INTO pregunta_auditoria (
		auditoria_id,
		pregunta_id,
		tab_id
	)
	SELECT
	  auditoria.auditoria_id,
	  pregunta.pregunta_id,
	  pregunta.tab_id
	FROM auditoria
	JOIN pregunta
	WHERE 
		auditoria.auditoria_id = (SELECT MAX(auditoria_id) FROM auditoria) and 
		(SELECT MAX(auditoria_id) FROM auditoria) not in (select distinct auditoria_id from pregunta_auditoria);
END;


CREATE TABLE 'pregunta'(
pregunta_id INTEGER PRIMARY KEY AUTOINCREMENT,
tab_id TEXT,
texto_pregunta TEXT,
desc_pregunta TEXT)

insert into pregunta (tab_id, texto_pregunta, desc_pregunta)
values
("controlEtiquetadoObligatoria", "1.1. El símbolo comunitario asociado a la DOP/IGP o ETG, según el caso","Art. 12.2 y 12.3 o 23.2 y 23.3 R (UE) 1151/2012 y puntos 1 y 2 del Anexo X R (UE) 668/2014"),
("controlEtiquetadoObligatoria", "1.2. La tipografía utilizada para el texto en el símbolo comunitario es Times New Roman en mayúsculas","Punto 3 Anexo X R (UE) 668/2014"),
("controlEtiquetadoObligatoria", "1.3. El símbolo comunitario tiene un diámetro mayor o igual a 15 mm que podrá reducirse a 10 mm  en envases o productos pequeños","Aquellos cuya superficie mayor del envase o producto es inferior a 80 cm2. Punto 4 Anexo X R (UE) 668/2014"),
("controlEtiquetadoObligatoria", "1.4. Los pantones utilizados en el símbolo comunitario son los establecidos en los puntos 1 y 2 del Anexo X del Reglamento (UE) 668/2014","Podrán utilizarse los colores blanco y negro en el logotipo si estos son los únicos colores de tinta utilizados en el envase. Puntos 1 y 2 Anexo X R (UE) 668/2014"),
("controlEtiquetadoObligatoria", "1.5. El idioma utilizado en el símbolo comunitario es alguno de los reconocidos como lenguas oficiales de la Unión Europea","Punto 5 Anexo X R (UE) 668/2014"),
("controlEtiquetadoObligatoria", "1.6. Figura el nombre registrado tal y como aparece inscrito en el Registro Comunitario como DOP/IGP o ETG, según el caso","Art. 12.2 ó 23.3 R (UE) 1151/2012"),
("controlEtiquetadoObligatoria", "1.7. El nombre registrado figura en el mismo campo visual que el símbolo de la Unión asociado a la DOP/IGP o ETG, según el caso ","Art. 12.3 ó 23.3 R (UE) 1151/2012"),


("controlEtiquetadoVoluntaria", "2.1. De figurar la mención completa del régimen de calidad, esta es, según el caso: 'denominación de origen protegida', 'indicación geográfica protegida' o 'especialidad tradicional garantizada'","Art 12.3 o 23.3 R (UE) 1151/2012"),
("controlEtiquetadoVoluntaria", "2.2. De figurar la abreviatura del régimen de calidad, esta es, según el caso: 'DOP', 'IGP' o 'ETG'","Art. 12.3 o 23.3 R (UE) 1151/2012"),
("controlEtiquetadoVoluntaria", "2.3. De figurar la mención completa o la abreviada de cualquiera de los regímenes de calidad, va acompañada del nombre registrado del régimen de calidad","Art. 12.3 o 23.3 R (UE) 1151/2012"),
("controlEtiquetadoVoluntaria", "2.4. La tipografía utilizada en la mención completa o en la abreviada es Times New Roman en mayúsculas","Punto 3 Anexo X R (UE) 668/2014"),
("controlEtiquetadoVoluntaria", "2.5. De figurar una representación de la zona geográfica de origen del producto y/o referencias textuales, gráficas o simbólicas al Estado miembro y/o la región donde se ubica dicha zona geográfica de origen, solo figura en el caso de las DOP/IGP","Art. 12.4 R (UE) 1151/2012"),

("controlNombreRegistradoDPOIGP", "3.1. Se cumple con la obligación de no realizar un uso indebido de un nombre registrado en productos no amparados por el registro, cuando dichos productos sean comparables a los productos registrados con ese nombre o cuando el uso del nombre se aproveche de la reputación del nombre protegido, incluso cuando esos productos se utilicen como ingredientes","Art. 13.1.a) R (UE) 1151/2012"),
("controlNombreRegistradoDPOIGP", "3.2. Se cumple con la obligación de no realizar un uso indebido, imitación o evocación, incluso si se indica el verdadero origen de los productos o servicios o si el nombre protegido se traduce o se acompaña de expresiones tales como «estilo», «tipo», «método», «producido como en», «imitación» o expresiones similares, incluso cuando esos productos se utilicen como ingredientes","Art. 13.1.b) R (UE) 1151/2012"),
("controlNombreRegistradoDPOIGP", "3.3. Se cumple con la obligación de no realizar cualquier tipo de indicación falsa o falaz en cuanto a la procedencia, el origen, la naturaleza o las características esenciales de los productos, que se emplee en el envase o en el embalaje, en la publicidad o en los documentos relativos a los productos de que se trate, así como la utilización de envases que por sus características puedan crear una impresión errónea acerca de su origen","Art. 13.1.c) R (UE) 1151/2012"),
("controlNombreRegistradoDPOIGP", "3.4. Se cumple con la obligación de no llevar a cabo cualquier otra práctica que pueda inducir a error al consumidor acerca del verdadero origen del producto","Art. 13.1.d) R (UE) 1151/2012"),

("controlNombreRegistradoETG", "4.1. Se cumple con la obligación de no realizar un uso indebido, imitación o evocación, así como cualquier otra práctica que pueda inducir a error al consumidor","Art. 24.1 R (UE) 1151/2012")

